#!/usr/bin/env node
import{relative as Me,dirname as We,join as _o}from"path";import{existsSync as ye}from"fs";import{homedir as Ce,platform as xo}from"os";import{join as f,parse as bo,dirname as xe}from"path";import{existsSync as H}from"fs";import{fileURLToPath as jo}from"url";var Ro=jo(import.meta.url),V=xe(Ro),Do=()=>{let e=Ce();switch(xo()){case"darwin":return f(e,"Library","Application Support","Code","User");case"win32":return f(e,"AppData","Roaming","Code","User");case"linux":return f(e,".config","Code","User");default:return f(e,".config","Code","User")}},Io=()=>{let e=process.cwd(),o=bo(e).root;for(;e!==o;){if(H(f(e,".agents")))return e;e=xe(e)}return process.cwd()},a={home:Ce(),vscodeUserDir:Do(),projectRoot:Io(),get projectClaudeSkills(){return f(this.projectRoot,".claude","skills")},get projectAgentsSkills(){return f(this.projectRoot,".agents","skills")},get projectSkillsDir(){return f(this.projectRoot,"skills")},get homePersonalSkills(){return f(this.home,".agents","skills")},get bootstrap(){return f(this.projectRoot,".agents","superpowers-bootstrap.md")},get superpowersRepo(){let e=f(V,"..","..","..","skills");return H(e)&&H(f(V,"..","..","..",".github","prompts"))?f(V,"..","..",".."):f(this.home,".agents","superpowers")},get homeSuperpowersSkills(){return f(this.superpowersRepo,"skills")},get isSuperpowersRepo(){let e=f(V,"..","..","..","skills");return H(e)&&H(f(V,"..","..","..",".github","prompts"))}};import{readFileSync as be}from"fs";var B=e=>{try{let t=be(e,"utf8").split(`
`),n={name:"",description:"",whenToUse:""},s=!1;for(let r of t){if(r.trim()==="---"){if(s)break;s=!0;continue}if(s){let l=r.match(/^(\w+):\s*(.*)$/);if(l){let[,i,p]=l,c={name:"name",description:"description",when_to_use:"whenToUse"};c[i]&&(n[c[i]]=p.trim())}}}return n}catch{return{name:"",description:"",whenToUse:""}}},je=e=>{try{let o=be(e,"utf8"),t=B(e),n=o.split(`
`),s=!1,r=!1,l=[];for(let i of n){if(i.trim()==="---"){if(s){r=!0;continue}s=!0;continue}(r||!s)&&l.push(i)}return{content:l.join(`
`).trim(),frontmatter:t}}catch(o){throw new Error(`Error reading skill file: ${o.message}`)}};import{existsSync as ue,readdirSync as Ie,statSync as Ee}from"fs";import{join as me,relative as Rs}from"path";import{readFileSync as Eo,existsSync as Uo}from"fs";import{join as Re}from"path";var K=e=>{let o=Re(e,"skill.json");if(!Uo(o))return null;try{let t=Eo(o,"utf8");return JSON.parse(t)}catch{return null}};var de=e=>e.startsWith("superpowers:")?{type:"superpowers",path:e.substring(12).replace(/^skills\//,"")}:e.startsWith("claude:")?{type:"claude",path:e.substring(7).replace(/^skills\//,"")}:{type:null,path:e.replace(/^skills\//,"")},De=(e,o)=>{let t=K(e);if(!t||!t.helpers||!Array.isArray(t.helpers))return null;let n=t.helpers,s=o.toLowerCase(),r=null,l=0;for(let i of n){let p=i.toLowerCase();if(p===s){r=i;break}if(p.includes(s)){let d=s.length/p.length;d>l&&(l=d,r=i)}let c=i.split("/").pop().split(".")[0].toLowerCase();if(s.includes(c)){let d=c.length/s.length;d>l&&(l=d,r=i)}}return r?Re(e,r):null},Y={claude:{dir:"projectClaudeSkills",prefix:"claude:"},project:{dir:"projectAgentsSkills",prefix:""},personal:{dir:"homePersonalSkills",prefix:""},superpowers:{dir:"homeSuperpowersSkills",prefix:"superpowers:"}};var Z=(e,o,t=null)=>{let n=[];if(!ue(e))return n;let s=(r,l)=>{if(!(t!==null&&l>t))try{let i=Ie(r,{withFileTypes:!0});for(let p of i){if(p.name==="node_modules"||p.name===".git"||p.name.startsWith("."))continue;let c=me(r,p.name),d=p.isDirectory();if(p.isSymbolicLink())try{d=Ee(c).isDirectory()}catch{continue}if(!d)continue;let u=me(c,"SKILL.md");ue(u)&&n.push(c),(t===null||l<t)&&s(c,l+1)}}catch{}};return s(e,0),n};var Ue=(e,o)=>{if(!ue(e))return[];let t=[],n=o.toLowerCase().replace(/\\/g,"/"),s=(r,l="")=>{try{let i=Ie(r,{withFileTypes:!0});for(let p of i){let c=me(r,p.name),d=l?`${l}/${p.name}`:p.name,u=p.isDirectory();if(p.isSymbolicLink())try{u=Ee(c).isDirectory()}catch{continue}if(!(u&&(p.name==="node_modules"||p.name===".git"||p.name.startsWith(".")))){if(u)s(c,d);else if(p.name==="SKILL.md"){let g=l.toLowerCase().replace(/\\/g,"/");(g===n||g.endsWith("/"+n)||g.endsWith(n))&&t.push({file:c,path:l})}}}}catch{}};return s(e),t},Ae=(e,o,t)=>{let n={project:"project skills (.agents/skills/)",claude:"claude skills (.claude/skills/)",personal:"personal skills (~/.agents/skills/)",superpowers:"superpowers skills (~/.agents/superpowers/skills/)"}[t];console.log(`Error: Multiple skills match "${e}" in ${n}:
`);for(let s of o){let l=Y[t].prefix+s.path;try{let i=B(s.file),p=i.description||i.whenToUse||"(no description)";console.log(`  ${l}`),console.log(`    ${p}
`)}catch{console.log(`  ${l}`),console.log(`    (unable to read description)
`)}}console.log("Please be more specific. Examples:");for(let s of o.slice(0,2)){let r=Y[t].prefix;console.log(`  superpowers-agent execute ${r}${s.path}`)}};import{existsSync as ge}from"fs";import{join as Ao,relative as Po}from"path";var To=e=>{let{type:o,path:t}=de(e),n={superpowers:a.homeSuperpowersSkills,claude:a.projectClaudeSkills,project:a.projectAgentsSkills,personal:a.homePersonalSkills},s;o?s=[{type:o,dir:n[o]}]:a.isSuperpowersRepo&&ge(a.projectSkillsDir)?s=[{type:"project",dir:a.projectSkillsDir},{type:"project",dir:a.projectAgentsSkills},{type:"claude",dir:a.projectClaudeSkills},{type:"personal",dir:a.homePersonalSkills},{type:"superpowers",dir:a.homeSuperpowersSkills}]:s=[{type:"project",dir:a.projectAgentsSkills},{type:"claude",dir:a.projectClaudeSkills},{type:"personal",dir:a.homePersonalSkills},{type:"superpowers",dir:a.homeSuperpowersSkills}];for(let{type:r,dir:l}of s){let i=Ue(l,t);if(i.length===1)return{skillFile:i[0].file,sourceType:r,actualSkillPath:i[0].path};i.length>1&&Ae(t,i,r)}return null},D=e=>{let o=To(e);if(o)return o;let{type:t,path:n}=de(e),s;t?s=[{type:t,dir:{superpowers:a.homeSuperpowersSkills,claude:a.projectClaudeSkills,project:a.projectAgentsSkills,personal:a.homePersonalSkills}[t]}]:a.isSuperpowersRepo&&ge(a.projectSkillsDir)?s=[{type:"project",dir:a.projectSkillsDir},{type:"project",dir:a.projectAgentsSkills},{type:"claude",dir:a.projectClaudeSkills},{type:"personal",dir:a.homePersonalSkills},{type:"superpowers",dir:a.homeSuperpowersSkills}]:s=[{type:"project",dir:a.projectAgentsSkills},{type:"claude",dir:a.projectClaudeSkills},{type:"personal",dir:a.homePersonalSkills},{type:"superpowers",dir:a.homeSuperpowersSkills}];for(let{type:r,dir:l}of s){if(!ge(l))continue;let i=Z(l,r,null);for(let p of i){let c=K(p);if(c&&c.aliases&&Array.isArray(c.aliases)){let d=n.toLowerCase();for(let u of c.aliases)if(u.toLowerCase()===d){let g=Ao(p,"SKILL.md"),h=Po(l,p);return{skillFile:g,sourceType:r,actualSkillPath:h}}}}}return null};import{readFileSync as Pe,writeFileSync as Te,existsSync as he}from"fs";import{join as I}from"path";import{execSync as Fo}from"child_process";var fe=()=>({auto_update:!0,last_update_check:null,last_updated_commit:null}),z=()=>{let e=I(a.superpowersRepo,".config.json");try{if(!he(e))return fe();let o=Pe(e,"utf8");return{...fe(),...JSON.parse(o)}}catch{return fe()}},ee=e=>{let o=I(a.superpowersRepo,".config.json"),n={...z(),...e};try{Te(o,JSON.stringify(n,null,2))}catch(s){console.log(`Warning: couldn't save config: ${s.message}`)}},Fe=e=>{let o=e?I(a.home,".agents","config.json"):I(process.cwd(),".agents","config.json");if(!he(o))return{};try{let t=Pe(o,"utf8");return JSON.parse(t)}catch{return{}}},vo=(e,o)=>{let t=o?I(a.home,".agents"):I(process.cwd(),".agents"),n=I(t,"config.json");try{return he(t)||Fo(`mkdir -p "${t}"`,{stdio:"pipe"}),Te(n,JSON.stringify(e,null,2),"utf8"),!0}catch(s){throw new Error(`Failed to write config: ${s.message}`)}},ke=(e=!1)=>Fe(e).repositories||{},ve=(e,o,t)=>{let n=Fe(t);n.repositories||(n.repositories={}),n.repositories[e]=o,vo(n,t)};import{readFileSync as No}from"fs";import{join as Ne,dirname as Lo}from"path";import{fileURLToPath as Oo}from"url";import{existsSync as Go}from"fs";import{execSync as Mo}from"child_process";var Wo=Oo(import.meta.url),Le=Lo(Wo),R=()=>{try{let e=Ne(Le,"package.json");return Go(e)||(e=Ne(Le,"..","..","package.json")),JSON.parse(No(e,"utf8")).version||"5.4.0"}catch{return"5.4.0"}},j=()=>{let e=R();console.log(`^^SAV:${e}^^`)},Oe=async()=>{try{let o=Mo('curl -sS "https://raw.githubusercontent.com/complexthings/superpowers/main/.agents/package.json"',{encoding:"utf8",timeout:1e4}),t=JSON.parse(o);return t.version?t.version:R()}catch(e){throw new Error(`Failed to fetch remote version: ${e.message}`)}},Ge=(e,o)=>{let t=e.split(".").map(Number),n=o.split(".").map(Number);for(let s=0;s<3;s++){let r=t[s]||0,l=n[s]||0;if(r>l)return!0;if(r<l)return!1}return!1};var Jo={project:{dir:"projectAgentsSkills",prefix:""},claude:{dir:"projectClaudeSkills",prefix:"claude:"},personal:{dir:"homePersonalSkills",prefix:""},superpowers:{dir:"homeSuperpowersSkills",prefix:"superpowers:"}},Vo=(e,o)=>{let t=_o(e,"SKILL.md"),{dir:n,prefix:s}=Jo[o],r=Me(a[n],e).replace(/\\/g,"/");console.log(`${s}${r}`);let{description:l,whenToUse:i}=B(t);l&&console.log(`  ${l}`),i&&console.log(`  When to use: ${i}`),console.log("")},A=()=>{j();let e=new Set,o=[{type:"project",dir:a.projectAgentsSkills,maxDepth:null},{type:"claude",dir:a.projectClaudeSkills,maxDepth:null},{type:"personal",dir:a.homePersonalSkills,maxDepth:null},{type:"superpowers",dir:a.homeSuperpowersSkills,maxDepth:null}];for(let{type:t,dir:n,maxDepth:s}of o){let r=Z(n,t,s);for(let l of r){let i=Me(n,l);e.has(i)||(e.add(i),Vo(l,t))}}console.log(`Usage:
  superpowers-agent execute <skill-name> # Load a specific skill`)},_e=()=>{j();let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent execute <skill-name-or-alias>

Examples:
  superpowers-agent execute brainstorming
  superpowers-agent execute superpowers:collaboration/brainstorming
  superpowers-agent execute aem/block-collection-and-party
  superpowers-agent execute block-collection  # Using alias

Description:
  Instructs the agent to execute the specified skill.
  Supports skill aliases defined in skill.json files.`);return}let o=D(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),A();return}let{skillFile:t,sourceType:n}=o,s=process.cwd(),r=t.startsWith(s),l=ye(a.projectAgentsSkills)||ye(a.projectClaudeSkills);console.log(r?`Open this file with your Read Tool: ${t}

<IMPORTANT>
USE YOUR Read Tool to process this file. DO NOT use \`cat\` or print commands.
</IMPORTANT>`:l&&n!=="project"?`Open this file with your Read Tool: ${t}

<IMPORTANT>
1. Try using your Read Tool first
2. If your Read tool fails (file outside workspace), use: cat "${t}"
3. Consider using workspace-local skills for better tool compatibility
   Run: superpowers-agent setup-skills
</IMPORTANT>`:`Open this file with your Read Tool: ${t}

<IMPORTANT>
1. Try using your Read Tool first
2. If your Read tool fails (file outside workspace), use: cat "${t}"
3. NEVER skip loading the skill content
</IMPORTANT>`)},Je=()=>{let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent path <skill-name-or-alias>

Examples:
  superpowers-agent path brainstorming
  superpowers-agent path superpowers:collaboration/brainstorming
  superpowers-agent path aem/block-collection-and-party
  superpowers-agent path block-collection  # Using alias

Description:
  Outputs the file system path of the specified SKILL.md file.
  Supports skill aliases defined in skill.json files.`);return}let o=D(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),A();return}let{skillFile:t}=o;console.log(t)},Ve=()=>{let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent dir <skill-name>

Examples:
  superpowers-agent dir brainstorming
  superpowers-agent dir aem/block-collection-and-party
  superpowers-agent dir block-collection  # Using alias
  superpowers-agent dir superpowers:testing/test-driven-development

Description:
  Returns the directory path where the specified skill is located.
  Supports skill aliases defined in skill.json files.`);return}let o=D(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),A();return}let{skillFile:t}=o,n=We(t);console.log(n)},He=()=>{j();let e=process.argv[3],o=process.argv[4];if(!e||!o){console.log(`Usage: superpowers-agent get-helpers <skill-name> <helper-search-term>

Examples:
  superpowers-agent get-helpers block-collection search-block
  superpowers-agent get-helpers aem/block-collection-and-party get-block-structure
  superpowers-agent get-helpers superpowers:testing/test-driven-development example

Description:
  Searches for helper files within a skill's skill.json configuration.
  Returns the full path to the best matching helper file.
  
  The command uses the skill's aliases if available, so you can use
  short names like "block-collection" instead of the full path.`);return}let t=D(e);if(!t){console.log(`Error: Skill not found: ${e}

Available skills:`),A();return}let{skillFile:n}=t,s=We(n),r=K(s);if(!r){console.log(`Error: No skill.json found for skill: ${e}
  Location: ${s}`);return}if(!r.helpers||!Array.isArray(r.helpers)||r.helpers.length===0){console.log(`Error: No helpers defined in skill.json for skill: ${e}
  Location: ${s}`);return}let l=De(s,o);if(!l){console.log(`Error: No helper found matching "${o}" in skill: ${e}`),console.log(`
Available helpers:`);for(let i of r.helpers)console.log(`  - ${i}`);return}if(!ye(l)){console.log(`Error: Helper file not found: ${l}
  Defined in skill.json but missing from filesystem`);return}console.log(l)},Be=()=>{let e=z();console.log("Current configuration:"),console.log(JSON.stringify(e,null,2))},Ke=()=>{let e=process.argv[3],o=process.argv[4];if(!e||o===void 0){console.log(`Usage: .agents/superpowers-agent config-set <key> <value>

Available keys:
  auto_update (true/false) - Enable/disable automatic updates during bootstrap

Examples:
  .agents/superpowers-agent config-set auto_update false
  .agents/superpowers-agent config-set auto_update true`);return}let t=o;o==="true"?t=!0:o==="false"&&(t=!1);let n={};n[e]=t,ee(n),console.log(`\u2713 Set ${e} = ${t}`)};import{execSync as Xo}from"child_process";import{execSync as E}from"child_process";var Ho=()=>{try{return E("git status --porcelain --untracked-files=no",{cwd:a.superpowersRepo,encoding:"utf8",stdio:"pipe",timeout:3e3}).trim().length===0}catch{return!1}},q=()=>{try{return E("git rev-parse --abbrev-ref HEAD",{cwd:a.superpowersRepo,encoding:"utf8",stdio:"pipe",timeout:3e3}).trim()==="main"}catch{return!1}},oe=()=>{try{E("git fetch origin",{cwd:a.superpowersRepo,timeout:5e3,stdio:"pipe"});let e=!Ho(),o=E("git rev-parse HEAD",{cwd:a.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim(),t=E("git rev-parse origin/main",{cwd:a.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim();if(!(o!==t))return{hasUpdates:!1,hasLocalChanges:e,currentCommit:o,latestCommit:t,commitsBehind:0,changedFiles:[]};let s=parseInt(E("git rev-list --count HEAD..origin/main",{cwd:a.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim(),10),l=E("git diff --name-only HEAD origin/main",{cwd:a.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim().split(`
`).filter(i=>i.length>0);return{hasUpdates:!0,hasLocalChanges:e,currentCommit:o,latestCommit:t,commitsBehind:s,changedFiles:l}}catch{return{hasUpdates:!1,hasLocalChanges:!1,currentCommit:"",latestCommit:"",commitsBehind:0,changedFiles:[],error:!0}}},Ye=e=>{let o={".github/prompts/":"copilot-prompts",".github/copilot-instructions.md":"copilot-instructions",".cursor/commands/":"cursor-commands","hooks/cursor/":"cursor-hooks",".codex/prompts/":"codex-prompts",".gemini/commands/":"gemini-commands","commands/":"claude-commands",".opencode/command/":"opencode-commands"},t=new Set;for(let n of e)for(let[s,r]of Object.entries(o))n.startsWith(s)&&t.add(r);return Array.from(t)};import{existsSync as se,readdirSync as Bo}from"fs";import{join as P,dirname as Ko}from"path";import{execSync as te}from"child_process";var T=()=>{let e=P(a.superpowersRepo,".github","prompts"),o=P(a.vscodeUserDir,"prompts");if(!se(e)){console.log("\u26A0\uFE0F  No Copilot prompts to install (source directory not found).");return}try{se(o)||te(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating prompts directory: ${s.message}`);return}let t;try{t=Bo(e).filter(s=>s.endsWith(".prompt.md"))}catch(s){console.log(`Error reading prompts directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No prompt files found to install.");return}console.log("Installing GitHub Copilot prompts...");let n=0;for(let s of t)try{let r=P(e,s),l=P(o,s);te(`cp "${r}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),n++}catch(r){console.log(`  \u2717 Failed to install ${s}: ${r.message}`)}n>0&&console.log(`
\u2713 Installed ${n} prompt(s) to ${o}
  Use slash commands in GitHub Copilot:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)},F=()=>{let e=P(a.superpowersRepo,".github","copilot-instructions.md"),o=P(a.home,".github","copilot-instructions.md");if(!se(e)){console.log("\u26A0\uFE0F  No Copilot instructions to install (source file not found).");return}let t=Ko(o);try{se(t)||te(`mkdir -p "${t}"`,{stdio:"pipe"})}catch(n){console.log(`Error creating .github directory: ${n.message}`);return}try{te(`cp "${e}" "${o}"`,{stdio:"pipe"}),console.log(`\u2713 Installed GitHub Copilot universal instructions
  Location: ${o}
  GitHub Copilot will now use Superpowers skills universally in all workspaces`)}catch(n){console.log(`\u2717 Failed to install instructions: ${n.message}`)}};import{existsSync as re,readdirSync as ze}from"fs";import{join as b}from"path";import{execSync as v}from"child_process";var N=()=>{let e=b(a.superpowersRepo,".cursor","commands"),o=b(a.home,".cursor","commands");if(!re(e)){console.log("\u26A0\uFE0F  No Cursor commands to install (source directory not found).");return}try{re(o)||v(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Cursor commands directory: ${s.message}`);return}let t;try{t=ze(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading Cursor commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Cursor commands...");let n=0;for(let s of t)try{let r=b(e,s),l=b(o,s);v(`cp "${r}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),n++}catch(r){console.log(`  \u2717 Failed to install ${s}: ${r.message}`)}n>0&&console.log(`
\u2713 Installed ${n} command(s) to ${o}
  Use slash commands in Cursor:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)},L=()=>{let e=b(a.superpowersRepo,"hooks","cursor"),o=b(a.home,".cursor","hooks"),t=b(e,"hooks.json"),n=b(a.home,".cursor","hooks.json");if(!re(e)){console.log("\u26A0\uFE0F  No Cursor hooks to install (source directory not found).");return}try{re(o)||v(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(l){console.log(`Error creating Cursor hooks directory: ${l.message}`);return}try{v(`cp "${t}" "${n}"`,{stdio:"pipe"}),console.log("  \u2713 Installed hooks.json")}catch(l){console.log(`  \u2717 Failed to install hooks.json: ${l.message}`);return}let s;try{s=ze(e).filter(l=>l.endsWith(".sh"))}catch(l){console.log(`Error reading hooks directory: ${l.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No hook scripts found to install.");return}console.log("Installing Cursor hooks...");let r=0;for(let l of s)try{let i=b(e,l),p=b(o,l);v(`cp "${i}" "${p}"`,{stdio:"pipe"}),v(`chmod +x "${p}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${l}`),r++}catch(i){console.log(`  \u2717 Failed to install ${l}: ${i.message}`)}r>0&&console.log(`
\u2713 Installed ${r} hook(s) to ${o}
  Cursor will now check for skills before each prompt submission
  Restart Cursor for hooks to take effect`)};import{existsSync as qe,readdirSync as Yo}from"fs";import{join as ne}from"path";import{execSync as Qe}from"child_process";var O=()=>{let e=ne(a.superpowersRepo,".codex","prompts"),o=ne(a.home,".codex","prompts");if(!qe(e)){console.log("\u26A0\uFE0F  No Codex prompts to install (source directory not found).");return}try{qe(o)||Qe(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Codex prompts directory: ${s.message}`);return}let t;try{t=Yo(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading Codex prompts directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No prompt files found to install.");return}console.log("Installing OpenAI Codex prompts...");let n=0;for(let s of t)try{let r=ne(e,s),l=ne(o,s);Qe(`cp "${r}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),n++}catch(r){console.log(`  \u2717 Failed to install ${s}: ${r.message}`)}n>0&&console.log(`
\u2713 Installed ${n} prompt(s) to ${o}
  Use slash commands in OpenAI Codex:
    /prompts:brainstorm - Refine ideas into designs
    /prompts:write-skill - Create new skills with TDD
    /prompts:skills - Discover available skills
    /prompts:use-skill - Load and apply a specific skill
  Note: Restart Codex or open a new session to reload prompts`)};import{existsSync as Xe,readdirSync as zo}from"fs";import{join as le}from"path";import{execSync as Ze}from"child_process";var G=()=>{let e=le(a.superpowersRepo,".gemini","commands"),o=le(a.home,".gemini","commands");if(!Xe(e)){console.log("\u26A0\uFE0F  No Gemini commands to install (source directory not found).");return}try{Xe(o)||Ze(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Gemini commands directory: ${s.message}`);return}let t;try{t=zo(e).filter(s=>s.endsWith(".toml"))}catch(s){console.log(`Error reading Gemini commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Gemini commands...");let n=0;for(let s of t)try{let r=le(e,s),l=le(o,s);Ze(`cp "${r}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),n++}catch(r){console.log(`  \u2717 Failed to install ${s}: ${r.message}`)}n>0&&console.log(`
\u2713 Installed ${n} command(s) to ${o}
  Use slash commands in Gemini:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};import{existsSync as eo,readdirSync as qo}from"fs";import{join as ie}from"path";import{execSync as oo}from"child_process";var M=()=>{let e=ie(a.superpowersRepo,"commands"),o=ie(a.home,".claude","commands");if(!eo(e)){console.log("\u26A0\uFE0F  No Claude commands to install (source directory not found).");return}try{eo(o)||oo(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Claude commands directory: ${s.message}`);return}let t;try{t=qo(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading Claude commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Claude Code commands...");let n=0;for(let s of t)try{let r=ie(e,s),l=ie(o,s);oo(`cp "${r}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),n++}catch(r){console.log(`  \u2717 Failed to install ${s}: ${r.message}`)}n>0&&console.log(`
\u2713 Installed ${n} command(s) to ${o}
  Use slash commands in Claude Code:
    /brainstorm - Refine ideas into designs
    /execute-plan - Execute plans in batches
    /write-plan - Create implementation plans
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};import{existsSync as so,readdirSync as Qo}from"fs";import{join as ae}from"path";import{execSync as to}from"child_process";var W=()=>{let e=ae(a.superpowersRepo,".opencode","command"),o=ae(a.home,".config","opencode","command");if(!so(e)){console.log("\u26A0\uFE0F  No opencode commands to install (source directory not found).");return}try{so(o)||to(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating opencode commands directory: ${s.message}`);return}let t;try{t=Qo(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading opencode commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing opencode commands...");let n=0;for(let s of t)try{let r=ae(e,s),l=ae(o,s);to(`cp "${r}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),n++}catch(r){console.log(`  \u2717 Failed to install ${s}: ${r.message}`)}n>0&&console.log(`
\u2713 Installed ${n} command(s) to ${o}
  Use slash commands in opencode:
    /brainstorm - Refine ideas into designs
    /execute-plan - Execute plans in batches
    /write-plan - Create implementation plans
    /write-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};var Zo=e=>{let t={"copilot-prompts":T,"copilot-instructions":F,"cursor-commands":N,"cursor-hooks":L,"codex-prompts":O,"gemini-commands":G,"claude-commands":M,"opencode-commands":W}[e];if(t)try{return t(),{success:!0,integration:e}}catch(n){return{success:!1,integration:e,error:n.message}}return{success:!1,integration:e,error:"Unknown integration"}},es=()=>{console.log("Installing aliases...")},ce=(e={})=>{let o=e.skipReinstall||!1;console.log(`# Checking for Superpowers updates...
`);let t=oe();if(t.error){console.log("\u26A0\uFE0F  Could not check for updates (network issue)");return}if(!t.hasUpdates){console.log("\u2713 Already up to date");return}if(t.hasLocalChanges){console.log(`\u26A0\uFE0F  Cannot auto-update: local changes detected
   Commit or stash your changes first, then run update again
   Or manually update: cd ${a.superpowersRepo} && git pull`);return}if(!q()){console.log(`\u26A0\uFE0F  Not on main branch, skipping auto-update
   Switch to main branch first: cd ${a.superpowersRepo} && git checkout main`);return}console.log(`\u{1F4E6} Updating from ${t.currentCommit.substring(0,7)} to ${t.latestCommit.substring(0,7)}
   (${t.commitsBehind} new commit${t.commitsBehind>1?"s":""})
`);try{Xo("git pull origin main",{cwd:a.superpowersRepo,stdio:"pipe",timeout:1e4}),console.log("\u2713 Updated superpowers repository")}catch(l){console.log(`\u2717 Git pull failed: ${l.message}
   Please resolve manually and try again`);return}if(console.log(""),ee({last_updated_commit:t.latestCommit,last_update_check:new Date().toISOString()}),o){console.log(`\u2139\uFE0F  Skipping integration reinstall (--no-reinstall flag)

\u2713 Update complete!`);return}let n=Ye(t.changedFiles);if(n.length===0){console.log(`\u2139\uFE0F  No integration files changed, skipping reinstalls

\u2713 Update complete!`);return}console.log(`\u{1F504} Reinstalling updated integrations:
`);let s=[];for(let l of n){let i=Zo(l);s.push(i),i.success?console.log(`  \u2713 ${l}`):console.log(`  \u2717 ${l} (${i.error})`)}console.log(""),console.log(`
---
`),es();let r=s.filter(l=>!l.success);if(r.length>0){console.log("\u26A0\uFE0F  Update completed with errors:");for(let l of r){console.log(`  - ${l.integration} failed to install`);let i=`install-${l.integration}`;console.log(`    Run manually: superpowers-agent ${i}`)}}else console.log("\u2713 Update complete!")},ro=async()=>{j();let e=R();console.log(`Current version: ${e}`);try{let o=await Oe();console.log(`Latest version: ${o}`),Ge(o,e)?(console.log("Update available: Yes"),process.exit(1)):(console.log("You are up to date"),process.exit(0))}catch(o){console.log(`Error checking for updates: ${o.message}`),process.exit(1)}},no=()=>{let e=R();console.log(e)};import{existsSync as S,readFileSync as we,writeFileSync as io}from"fs";import{join as k,dirname as ss,parse as ao}from"path";import{execSync as _}from"child_process";import{platform as ts}from"os";import{execSync as os}from"child_process";var Q=e=>{try{return os(`which ${e}`,{stdio:"pipe",timeout:2e3}),!0}catch{return!1}};var m={opencode:{check:()=>Q("opencode"),cli:!0,name:"OpenCode",installUrl:"https://opencode.ai/docs/installation",bootstrapCommand:"install-opencode-commands"},claude:{check:()=>Q("claude"),cli:!0,name:"Claude Code",installUrl:"https://code.claude.com/docs/en/installation",bootstrapCommand:"install-claude-commands"},gemini:{check:()=>Q("gemini"),cli:!0,name:"Gemini",installUrl:"https://cloud.google.com/gemini/docs/cli/install",bootstrapCommand:"install-gemini-commands"},codex:{check:()=>Q("codex"),cli:!0,name:"Codex",installUrl:"https://developers.openai.com/codex/docs/installation",bootstrapCommand:"install-codex-prompts"},cursor:{check:()=>!0,cli:!1,name:"Cursor",bootstrapCommand:"install-cursor-commands"},copilot:{check:()=>!0,cli:!1,name:"GitHub Copilot",bootstrapCommand:"install-copilot-prompts"}},lo=()=>{let e=[];return m.copilot.check()&&e.push("github-copilot"),m.cursor.check()&&e.push("cursor"),m.claude.check()&&e.push("claude-code"),m.opencode.check()&&e.push("opencode"),m.gemini.check()&&e.push("gemini"),m.codex.check()&&e.push("codex"),e};var rs=e=>{let o={"github-copilot":"GitHub Copilot",cursor:"Cursor","claude-code":"Claude Code",opencode:"OpenCode",gemini:"Gemini",codex:"Codex"};return e.map(n=>`**Tool Mapping for ${o[n]}:**`).join(`
`)},co=(e,o,t,n=!0)=>{let s=S(e);if(!s&&!n)return{updated:!1,created:!1,skipped:!0};let r=rs(t),l=o.replace(/\{\{TOOL_MAPPINGS\}\}/g,r),i=new Date().toISOString().split("T")[0];l=l.replace(/\{\{DATE\}\}/g,i),l=l.replace(/\{\{SUPERPOWERS_PATH\}\}/g,a.superpowersRepo);let p=`<!-- SUPERPOWERS_SKILLS_START -->
${l}
<!-- SUPERPOWERS_SKILLS_END -->`;if(s){let c=new Date().toISOString().split("T")[0],d=`${e}.backup-${c}`;try{_(`cp "${e}" "${d}"`,{stdio:"pipe"})}catch(w){return{updated:!1,error:!0,message:`Failed to backup: ${w.message}`}}let u;try{u=we(e,"utf8")}catch(w){return{updated:!1,error:!0,message:`Failed to read: ${w.message}`}}let g="<!-- SUPERPOWERS_SKILLS_START -->",h="<!-- SUPERPOWERS_SKILLS_END -->",x;if(u.includes(g)&&u.includes(h)){let w=new RegExp(`${g}[\\s\\S]*?${h}`,"g");x=u.replace(w,p)}else{let w=u.match(/^#\s+.+$/m);if(w){let X=u.indexOf(`
`,w.index)+1;x=u.slice(0,X)+`
`+p+`
`+u.slice(X)}else x=p+`

`+u}try{return io(e,x,"utf8"),{updated:!0,created:!1,backup:d}}catch(w){return{updated:!1,error:!0,message:`Failed to write: ${w.message}`}}}else try{let c=ss(e);S(c)||_(`mkdir -p "${c}"`,{stdio:"pipe"});let g=`# ${ao(e).base.toUpperCase()}

`+p;return io(e,g,"utf8"),{updated:!1,created:!0}}catch(c){return{updated:!1,created:!1,error:!0,message:`Failed to create: ${c.message}`}}},ns=()=>{console.log("Installing Unix aliases...");let e=k(a.superpowersRepo,".agents","superpowers-agent");S(e)?console.log(`\u2713 Alias available at: ${e}`):console.log("\u26A0\uFE0F  superpowers-agent executable not found")},ls=()=>{console.log("Installing Windows aliases..."),console.log("\u2713 Windows alias installation (implementation pending)")},is=()=>{let e=ts();return console.log(`## Installing Universal Aliases
`),e==="win32"?ls():ns()},po=()=>{j(),console.log(`# Setting up Superpowers skills for this project
`);let e=process.cwd(),o=k(e,".agents"),t=k(o,"skills"),n=k(e,"AGENTS.md"),s=k(o,"AGENTS.md"),r=S(n)?n:s,l=k(a.superpowersRepo,".agents","templates","AGENTS.md.template");if(!S(l)){console.log(`\u2717 Error: AGENTS.md template not found
  Expected at: ${l}
  Please update your Superpowers installation`);return}if(S(o))console.log("\u2713 .agents/ directory exists");else try{_(`mkdir -p "${o}"`,{stdio:"pipe"}),console.log("\u2713 Created .agents/ directory")}catch(C){console.log(`\u2717 Failed to create .agents/ directory: ${C.message}`);return}if(S(t))console.log("\u2713 .agents/skills/ directory exists");else try{_(`mkdir -p "${t}"`,{stdio:"pipe"}),_(`touch "${k(t,".gitkeep")}"`,{stdio:"pipe"}),console.log("\u2713 Created .agents/skills/ directory")}catch(C){console.log(`\u2717 Failed to create skills directory: ${C.message}`);return}let i=S(r);if(i){let C=new Date().toISOString().split("T")[0],$e=`${r}.backup-${C}`;try{_(`cp "${r}" "${$e}"`,{stdio:"pipe"}),console.log(`\u2713 Backed up existing AGENTS.md to ${ao($e).base}`)}catch(Co){console.log(`\u2717 Failed to backup AGENTS.md: ${Co.message}`);return}}let p;try{p=we(l,"utf8")}catch(C){console.log(`\u2717 Failed to read template: ${C.message}`);return}let c=R();p=p.replace(/\{\{VERSION\}\}/g,c);let d=[],u=k(e,".github","copilot-instructions.md"),g=k(a.home,".github","copilot-instructions.md");(S(u)||S(g)||m.copilot.check())&&d.push("github-copilot");let h=k(e,"CLAUDE.md"),x=k(o,"CLAUDE.md");(S(h)||S(x)||m.claude.check())&&d.push("claude-code");let w=k(e,"GEMINI.md"),X=k(o,"GEMINI.md");(S(w)||S(X)||m.gemini.check())&&d.push("gemini"),m.cursor.check()&&d.push("cursor"),m.opencode.check()&&d.push("opencode"),m.codex.check()&&d.push("codex"),console.log(`
Detected platforms for project: ${d.join(", ")||"none"}
`);let $o=d.filter(C=>["github-copilot","cursor","opencode","codex"].includes(C)),pe=co(r,p,$o,!i);pe.created?console.log(`\u2713 Created AGENTS.md with platform tool mappings (${r===n?"root":".agents/"})`):pe.updated?console.log(`\u2713 Updated AGENTS.md with platform tool mappings (${r===n?"root":".agents/"})`):pe.error&&console.log("\u26A0\uFE0F  Failed to update AGENTS.md"),console.log(`
# Setup complete!

Your project now has:
  - .agents/ directory structure
  - AGENTS.md with universal skills instructions
  - .agents/skills/ ready for project-specific skills
`)},uo=()=>{if(j(),console.log(`# Superpowers Bootstrap for Agents
# ==================================
`),!process.argv.includes("--no-update")){let p=z(),c=oe();c.error?console.log(`## Update Check

\u26A0\uFE0F  Could not check for updates (network issue)

---
`):c.hasUpdates&&(p.auto_update&&!c.hasLocalChanges&&q()?(console.log(`## Auto-Update
`),ce(),console.log(`
---
`)):(console.log(`## Update Available
`),c.hasLocalChanges?console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    Cannot auto-update: local changes detected\n    To update, commit/stash changes then run: `superpowers-agent update`"):q()?console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    To update, run: `superpowers-agent update`\n    Or enable auto-update: `superpowers-agent config-set auto_update true`"):console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    Cannot auto-update: not on main branch\n    To update, switch to main then run: `superpowers-agent update`"),console.log(`
---
`)))}is(),console.log(`---
`),console.log(`## GitHub Copilot Integration
`),T(),console.log(""),F(),console.log(`
---
`),console.log(`## Cursor Integration
`),N(),console.log(""),L(),console.log(`
---
`),console.log(`## OpenAI Codex Integration
`),m.codex.check()?O():console.log(`\u26A0\uFE0F  Skipped (${m.codex.name} CLI not detected)
\u{1F4A1} To enable Codex integration:
   1. Install Codex: ${m.codex.installUrl}
   2. Run: superpowers-agent ${m.codex.bootstrapCommand}`),console.log(`
---
`),console.log(`## Gemini Integration
`),m.gemini.check()?G():console.log(`\u26A0\uFE0F  Skipped (${m.gemini.name} CLI not detected)
\u{1F4A1} To enable Gemini integration:
   1. Install Gemini: ${m.gemini.installUrl}
   2. Run: superpowers-agent ${m.gemini.bootstrapCommand}`),console.log(`
---
`),console.log(`## Claude Code Integration
`),m.claude.check()?M():console.log(`\u26A0\uFE0F  Skipped (${m.claude.name} CLI not detected)
\u{1F4A1} To enable Claude Code integration:
   1. Install Claude Code: ${m.claude.installUrl}
   2. Run: superpowers-agent ${m.claude.bootstrapCommand}`),console.log(`
---
`),console.log(`## OpenCode Integration
`),m.opencode.check()?W():console.log(`\u26A0\uFE0F  Skipped (${m.opencode.name} CLI not detected)
\u{1F4A1} To enable OpenCode integration:
   1. Install OpenCode: ${m.opencode.installUrl}
   2. Run: superpowers-agent ${m.opencode.bootstrapCommand}`),console.log(`
---
`),console.log(`## Generating Platform-Specific Files
`);let r=lo();console.log(`Detected platforms: ${r.join(", ")||"none"}
`);let l=k(a.superpowersRepo,".agents","templates","AGENTS.md.template"),i="";try{i=we(l,"utf8")}catch(p){console.log(`\u26A0\uFE0F  Could not read AGENTS.md template: ${p.message}
`)}if(i){let p=R();i=i.replace(/\{\{VERSION\}\}/g,p);let c=k(a.home,".agents","AGENTS.md"),d=co(c,i,r,!0);d.created?console.log(`\u2713 Created ${c}`):d.updated&&console.log(`\u2713 Updated ${c}`)}console.log(`
---
`),console.log(`# Bootstrap Complete!
`),console.log("\u2713 All integrations installed"),console.log(`\u2713 Skills system ready
`),console.log("Next steps:"),console.log("  - Run `superpowers-agent find-skills` to see available skills"),console.log("  - Run `superpowers-agent setup-skills` in your project directory")};import{existsSync as U,readFileSync as fo}from"fs";import{join as y,dirname as ho,parse as mo}from"path";import{execSync as $}from"child_process";import{homedir as J}from"os";var as=e=>{let o=e.match(/^https:\/\/github\.com\/([^/]+)\/([^/]+)\/tree\/([^/]+)\/(.+)$/);if(o){let[,s,r,l,i]=o;return{type:"git-tree",repoUrl:`https://github.com/${s}/${r}.git`,branch:l,path:i,original:e}}let t=e.match(/^git@github\.com:([^/]+)\/([^/]+?)(?:\.git)?$/);if(t){let[,s,r]=t;return{type:"git-repo",repoUrl:`git@github.com:${s}/${r}.git`,branch:null,path:null,original:e}}let n=e.match(/^https:\/\/github\.com\/([^/]+)\/([^/]+)(?:\.git)?$/);if(n){let[,s,r]=n;return{type:"git-repo",repoUrl:`https://github.com/${s}/${r}.git`,branch:null,path:null,original:e}}return U(e)?{type:"local",path:e,original:e}:null},cs=e=>{let o=e.includes("--global")||e.includes("-g"),t=e.includes("--project")||e.includes("-p");if(o)return y(J(),".agents","skills");if(t)return y(process.cwd(),".agents","skills");let n=y(process.cwd(),".agents","config.json"),s=y(J(),".agents","config.json");for(let r of[n,s])if(U(r))try{if(JSON.parse(fo(r,"utf8")).installLocation==="project")return y(process.cwd(),".agents","skills")}catch{}return y(J(),".agents","skills")},ps=(e,o)=>{let t=y(J(),".agents","tmp",`skill-install-${Date.now()}`);try{return $(`mkdir -p "${t}"`,{stdio:"pipe"}),o?$(`git clone --branch ${o} --depth 1 "${e}" "${t}"`,{stdio:"pipe",timeout:3e4}):$(`git clone --depth 1 "${e}" "${t}"`,{stdio:"pipe",timeout:3e4}),t}catch(n){try{$(`rm -rf "${t}"`,{stdio:"pipe"})}catch{}throw new Error(`Failed to clone repository: ${n.message}`)}},Se=e=>{let o=y(e,"skill.json");if(!U(o))return null;try{let t=fo(o,"utf8");return JSON.parse(t)}catch(t){throw new Error(`Failed to read skill.json: ${t.message}`)}},go=(e,o,t,n)=>{let s=y(e,o);if(!U(s)){n.errors.push(`Skill directory not found: ${o}`);return}let r=Se(s);if(!r){n.errors.push(`No skill.json found in: ${o}`);return}let l=r.name||o,i=y(t,l),p=ho(i);try{$(`mkdir -p "${p}"`,{stdio:"pipe"})}catch(c){n.errors.push(`Failed to create directory ${p}: ${c.message}`);return}try{U(i)&&$(`rm -rf "${i}"`,{stdio:"pipe"}),$(`cp -R "${s}" "${i}"`,{stdio:"pipe"}),n.installed.push({name:l,path:i,title:r.title||r.description||l})}catch(c){n.errors.push(`Failed to install ${o}: ${c.message}`)}},ko=()=>{let e=process.argv.slice(3),o=e.find(c=>!c.startsWith("-")),t=e.filter(c=>c.startsWith("-"));if(!o){console.log(`Usage: superpowers-agent add <url-or-path|@alias> [skill-path] [options]

Options:
  --global, -g   Install skills globally in ~/.agents/skills/ (default)
  --project, -p  Install skills in current project's .agents/skills/

Examples:
  superpowers-agent add https://github.com/example/skills
  superpowers-agent add https://github.com/example/repo/tree/main/skills
  superpowers-agent add ~/my-local-skills
  superpowers-agent add https://github.com/example/skills --project
  superpowers-agent add ~/my-local-skills --global
  superpowers-agent add @myrepo path/to/skill
  superpowers-agent add @myrepo path/to/skills --project

Description:
  Installs skill(s) from a Git repository, local directory, or repository alias.
  Supports repositories with single or multiple skills.
  Reads skill.json to determine skill names and installation paths.
  
  Repository aliases can be added using:
    superpowers-agent add-repository <git-url> [--as=@alias]`);return}console.log(`Installing skill(s)...
`);let n=null,s=null;if(o.startsWith("@")){let c=o;s=e.find((h,x)=>x>0&&!h.startsWith("-")&&h!==c);let d=ke(!1),u=ke(!0);if(d[c])n=d[c],console.log(`Using project repository alias: ${c}`);else if(u[c])n=u[c],console.log(`Using global repository alias: ${c}`);else{console.log(`Error: Repository alias not found: ${c}`),console.log(`
Available aliases:`);let h={...u,...d};if(Object.keys(h).length===0)console.log("  (none)"),console.log(`
Add a repository using:`),console.log("  superpowers-agent add-repository <git-url>");else for(let[x,w]of Object.entries(h))console.log(`  ${x} -> ${w}`);return}let g=U(n);s?g?(o=y(n,s),console.log(`Repository path: ${n}`),console.log(`Skill path: ${s}
`)):(o=`${n}/tree/main/${s}`,console.log(`Repository URL: ${n}`),console.log(`Skill path: ${s}
`)):(o=n,console.log(g?`Repository path: ${n}
`:`Repository URL: ${n}
`))}let r=as(o);if(!r){console.log(`Error: Invalid URL or path not found: ${o}`);return}let l=cs(t);console.log(`Install location: ${l}
`);let i,p=!1;try{if(r.type==="git-repo"||r.type==="git-tree"){if(console.log(`Cloning repository: ${r.repoUrl}`),r.branch&&console.log(`Branch: ${r.branch}`),i=ps(r.repoUrl,r.branch),p=!0,r.path&&(i=y(i,r.path),!U(i)))throw new Error(`Path not found in repository: ${r.path}`);console.log("")}else i=r.path;let c=Se(i);if(!c)throw new Error("No skill.json found in source directory");let d={installed:[],errors:[],source:r.original};if(c.skills&&Array.isArray(c.skills)){console.log(`Found ${c.skills.length} skill(s) to install
`);for(let u of c.skills)go(i,u,l,d)}else{let u=c.name||mo(i).base;go(ho(i),mo(i).base,l,d)}if(p&&i)try{let u=i.split("/.agents/tmp/")[0]+"/.agents/tmp/"+i.split("/.agents/tmp/")[1].split("/")[0];$(`rm -rf "${u}"`,{stdio:"pipe"})}catch{}if(console.log(`
**Successfully installed skills:**`),console.log(`- Source: ${d.source}`),d.installed.length>0)for(let u of d.installed)console.log(`  - Installed: ${u.name} at ${u.path}`),console.log(`    ${u.title}`);if(d.errors.length>0){console.log(`
**Errors:**`);for(let u of d.errors)console.log(`  - ${u}`)}d.installed.length===0&&d.errors.length===0&&console.log("  No skills were installed")}catch(c){if(p&&i)try{let d=i.split("/.agents/tmp/")[0]+"/.agents/tmp/"+i.split("/.agents/tmp/")[1].split("/")[0];$(`rm -rf "${d}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${c.message}`)}},yo=()=>{let e=process.argv.slice(3),o=e.find(c=>!c.startsWith("-")),t=e.filter(c=>c.startsWith("-"));if(!o){console.log(`Usage: superpowers-agent add-repository <git-url> [options]

Options:
  --global, -g        Add repository globally in ~/.agents/config.json (default)
  --project, -p       Add repository in current project's .agents/config.json
  --as=<alias>        Specify custom alias for the repository

Examples:
  superpowers-agent add-repository https://github.com/example/skills.git
  superpowers-agent add-repository https://github.com/example/skills.git --as=@myskills
  superpowers-agent add-repository https://github.com/example/skills.git --project
  superpowers-agent add-repository https://github.com/example/skills.git --as=@custom --global

Description:
  Adds a skill repository alias to your configuration.
  The repository's skill.json will be read to determine the default alias.
  Use --as to specify a custom alias.
  After adding, you can install skills using: superpowers-agent add @alias path/to/skill`);return}console.log(`Adding repository...
`);let n=t.some(c=>c==="--global"||c==="-g"),s=t.some(c=>c==="--project"||c==="-p"),r=t.find(c=>c.startsWith("--as=")),l=r?r.split("=")[1]:null,i=!s,p;try{console.log(`Cloning repository: ${o}`),p=y(J(),".agents","tmp",`repo-add-${Date.now()}`),$(`mkdir -p "${p}"`,{stdio:"pipe"}),$(`git clone --depth 1 "${o}" "${p}"`,{stdio:"pipe",timeout:3e4}),console.log("");let c=Se(p);if(!c)throw new Error("No skill.json found in repository");let d;if(l)d=l;else if(c.repository)d=c.repository;else{let h=o.match(/\/([^/]+?)(?:\.git)?$/);if(h)d="@"+h[1];else throw new Error("Could not determine repository alias. Use --as=@alias to specify manually.")}ve(d,o,i),$(`rm -rf "${p}"`,{stdio:"pipe"});let u=i?"globally":"in project",g=i?y(J(),".agents","config.json"):y(process.cwd(),".agents","config.json");console.log(`\u2713 Repository added ${u}`),console.log(`  Alias: ${d}`),console.log(`  URL: ${o}`),console.log(`  Config: ${g}`),console.log(`
You can now install skills using:`),console.log(`  superpowers-agent add ${d} <path-to-skill>`)}catch(c){if(p)try{$(`rm -rf "${p}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${c.message}`)}};import{dirname as ds}from"path";var wo=e=>{if(!e){console.log(`Usage: superpowers-agent use-skill <skill-name>

Examples (smart matching):
  superpowers-agent use-skill brainstorming              # Matches superpowers:collaboration/brainstorming
  superpowers-agent use-skill collaboration/brainstorming # More specific suffix
  superpowers-agent use-skill test-driven-development    # Matches superpowers:testing/test-driven-development

Examples (explicit paths):
  superpowers-agent use-skill superpowers:collaboration/brainstorming  # Full superpowers skill path
  superpowers-agent use-skill claude:email-assistant                   # Full claude skill path
  superpowers-agent use-skill my-custom-skill                          # Project skill

Smart matching:
  - Type just the skill name or any suffix of the path
  - Priority: .agents/skills/ > .claude/skills/ > ~/.agents/skills/ > ~/.agents/superpowers/skills/
  - If multiple skills match at same priority, you'll see them with descriptions`);return}let o=D(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),console.log("Run: superpowers-agent find-skills");return}let{skillFile:t,sourceType:n,actualSkillPath:s}=o;try{let{content:r,frontmatter:l}=je(t),i=Y[n].prefix+s,p=ds(t),c=`# ${l.name||i}`;l.description&&(c+=`
# ${l.description}`),l.whenToUse&&(c+=`
# When to use: ${l.whenToUse}`),c+=`
# Supporting tools and docs are in ${p}
# ============================================

${r}`,console.log(c)}catch(r){console.log(r.message)}};var So={bootstrap:uo,version:no,"check-updates":()=>{ro().catch(e=>{console.error(e.message),process.exit(1)})},update:()=>{let e=process.argv.includes("--no-reinstall");ce({skipReinstall:e})},"config-get":Be,"config-set":Ke,"setup-skills":po,"use-skill":()=>wo(process.argv[3]),execute:_e,"find-skills":A,add:ko,"add-repository":yo,dir:Ve,path:Je,"get-helpers":He,"install-copilot-prompts":T,"install-copilot-instructions":F,"install-cursor-commands":N,"install-cursor-hooks":L,"install-codex-prompts":O,"install-gemini-commands":G,"install-claude-commands":M,"install-opencode-commands":W,default:()=>{console.log(`Superpowers for Agents
Usage:
  superpowers-agent bootstrap [--no-update]                         # Run complete bootstrap
  superpowers-agent version                                         # Show current version
  superpowers-agent check-updates                                   # Check for updates
  superpowers-agent update [--no-reinstall]                         # Update to latest version
  superpowers-agent config-get                                      # Show configuration
  superpowers-agent config-set <key> <value>                        # Update configuration
  superpowers-agent setup-skills                                    # Initialize project skills
  superpowers-agent use-skill <skill-name>                          # Load a skill
  superpowers-agent find-skills                                     # List available skills
  superpowers-agent add <url-or-path|@alias> [path] [options]      # Install skills
  superpowers-agent add-repository <git-url> [--as=@alias] [opts]  # Add repository alias
  superpowers-agent dir <skill-name>                                # Get skill directory
  superpowers-agent path <skill-name>                               # Get skill file path
  superpowers-agent execute <skill-name>                            # Execute a skill
  superpowers-agent get-helpers <skill> <search-term>               # Get helper file path
  superpowers-agent install-copilot-prompts                         # Install GitHub Copilot prompts
  superpowers-agent install-copilot-instructions                    # Install universal instructions
  superpowers-agent install-cursor-commands                         # Install Cursor commands
  superpowers-agent install-cursor-hooks                            # Install Cursor hooks
  superpowers-agent install-codex-prompts                           # Install Codex prompts
  superpowers-agent install-gemini-commands                         # Install Gemini commands
  superpowers-agent install-claude-commands                         # Install Claude commands
  superpowers-agent install-opencode-commands                       # Install OpenCode commands

Documentation: https://github.com/complexthings/superpowers
`)}},us=process.argv[2]||"default",ms=So[us]||So.default;try{ms()}catch(e){console.error(`Error: ${e.message}`),process.exit(1)}
