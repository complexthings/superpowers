#!/usr/bin/env node
import{relative as ao,dirname as co,join as ms}from"path";import{existsSync as Ne}from"fs";import{homedir as Be,platform as zo}from"os";import{join as w,parse as qo,dirname as Ve}from"path";import{existsSync as ee}from"fs";import{fileURLToPath as Xo}from"url";var Qo=Xo(import.meta.url),Z=Ve(Qo),Zo=()=>{let e=Be();switch(zo()){case"darwin":return w(e,"Library","Application Support","Code","User");case"win32":return w(e,"AppData","Roaming","Code","User");case"linux":return w(e,".config","Code","User");default:return w(e,".config","Code","User")}},es=()=>{let e=process.cwd(),o=qo(e).root;for(;e!==o;){if(ee(w(e,".agents")))return e;e=Ve(e)}return process.cwd()},c={home:Be(),vscodeUserDir:Zo(),projectRoot:es(),get projectClaudeSkills(){return w(this.projectRoot,".claude","skills")},get projectAgentsSkills(){return w(this.projectRoot,".agents","skills")},get projectSkillsDir(){return w(this.projectRoot,"skills")},get homePersonalSkills(){return w(this.home,".agents","skills")},get bootstrap(){return w(this.projectRoot,".agents","superpowers-bootstrap.md")},get superpowersRepo(){let e=w(Z,"..","..","..","skills");return ee(e)&&ee(w(Z,"..","..","..",".github","prompts"))?w(Z,"..","..",".."):w(this.home,".agents","superpowers")},get homeSuperpowersSkills(){return w(this.superpowersRepo,"skills")},get isSuperpowersRepo(){let e=w(Z,"..","..","..","skills");return ee(e)&&ee(w(Z,"..","..","..",".github","prompts"))}};import{readFileSync as Ke}from"fs";var oe=e=>{try{let t=Ke(e,"utf8").split(`
`),r={name:"",description:"",whenToUse:""},s=!1;for(let n of t){if(n.trim()==="---"){if(s)break;s=!0;continue}if(s){let l=n.match(/^(\w+):\s*(.*)$/);if(l){let[,i,d]=l,a={name:"name",description:"description",when_to_use:"whenToUse"};a[i]&&(r[a[i]]=d.trim())}}}return r}catch{return{name:"",description:"",whenToUse:""}}},Ye=e=>{try{let o=Ke(e,"utf8"),t=oe(e),r=o.split(`
`),s=!1,n=!1,l=[];for(let i of r){if(i.trim()==="---"){if(s){n=!0;continue}s=!0;continue}(n||!s)&&l.push(i)}return{content:l.join(`
`).trim(),frontmatter:t}}catch(o){throw new Error(`Error reading skill file: ${o.message}`)}};import{existsSync as Ae,readdirSync as Xe,statSync as Qe}from"fs";import{join as Te,relative as ot}from"path";import{readFileSync as os,existsSync as ss}from"fs";import{join as ze}from"path";var se=e=>{let o=ze(e,"skill.json");if(!ss(o))return null;try{let t=os(o,"utf8");return JSON.parse(t)}catch{return null}};var Pe=e=>e.startsWith("superpowers:")?{type:"superpowers",path:e.substring(12).replace(/^skills\//,"")}:e.startsWith("claude:")?{type:"claude",path:e.substring(7).replace(/^skills\//,"")}:{type:null,path:e.replace(/^skills\//,"")},qe=(e,o)=>{let t=se(e);if(!t||!t.helpers||!Array.isArray(t.helpers))return null;let r=t.helpers,s=o.toLowerCase(),n=null,l=0;for(let i of r){let d=i.toLowerCase();if(d===s){n=i;break}if(d.includes(s)){let p=s.length/d.length;p>l&&(l=p,n=i)}let a=i.split("/").pop().split(".")[0].toLowerCase();if(s.includes(a)){let p=a.length/s.length;p>l&&(l=p,n=i)}}return n?ze(e,n):null},te={claude:{dir:"projectClaudeSkills",prefix:"claude:"},project:{dir:"projectAgentsSkills",prefix:""},personal:{dir:"homePersonalSkills",prefix:""},superpowers:{dir:"homeSuperpowersSkills",prefix:"superpowers:"}};var de=(e,o,t=null)=>{let r=[];if(!Ae(e))return r;let s=(n,l)=>{if(!(t!==null&&l>t))try{let i=Xe(n,{withFileTypes:!0});for(let d of i){if(d.name==="node_modules"||d.name===".git"||d.name.startsWith("."))continue;let a=Te(n,d.name),p=d.isDirectory();if(d.isSymbolicLink())try{p=Qe(a).isDirectory()}catch{continue}if(!p)continue;let u=Te(a,"SKILL.md");Ae(u)&&r.push(a),(t===null||l<t)&&s(a,l+1)}}catch{}};return s(e,0),r};var Ze=(e,o)=>{if(!Ae(e))return[];let t=[],r=o.toLowerCase().replace(/\\/g,"/"),s=(n,l="")=>{try{let i=Xe(n,{withFileTypes:!0});for(let d of i){let a=Te(n,d.name),p=l?`${l}/${d.name}`:d.name,u=d.isDirectory();if(d.isSymbolicLink())try{u=Qe(a).isDirectory()}catch{continue}if(!(u&&(d.name==="node_modules"||d.name===".git"||d.name.startsWith(".")))){if(u)s(a,p);else if(d.name==="SKILL.md"){let h=l.toLowerCase().replace(/\\/g,"/");(h===r||h.endsWith("/"+r)||h.endsWith(r))&&t.push({file:a,path:l})}}}}catch{}};return s(e),t},eo=(e,o,t)=>{let r={project:"project skills (.agents/skills/)",claude:"claude skills (.claude/skills/)",personal:"personal skills (~/.agents/skills/)",superpowers:"superpowers skills (~/.agents/superpowers/skills/)"}[t];console.log(`Error: Multiple skills match "${e}" in ${r}:
`);for(let s of o){let l=te[t].prefix+s.path;try{let i=oe(s.file),d=i.description||i.whenToUse||"(no description)";console.log(`  ${l}`),console.log(`    ${d}
`)}catch{console.log(`  ${l}`),console.log(`    (unable to read description)
`)}}console.log("Please be more specific. Examples:");for(let s of o.slice(0,2)){let n=te[t].prefix;console.log(`  superpowers-agent execute ${n}${s.path}`)}};import{existsSync as Fe}from"fs";import{join as ts,relative as rs}from"path";var ns=e=>{let{type:o,path:t}=Pe(e),r={superpowers:c.homeSuperpowersSkills,claude:c.projectClaudeSkills,project:c.projectAgentsSkills,personal:c.homePersonalSkills},s;o?s=[{type:o,dir:r[o]}]:c.isSuperpowersRepo&&Fe(c.projectSkillsDir)?s=[{type:"project",dir:c.projectSkillsDir},{type:"project",dir:c.projectAgentsSkills},{type:"claude",dir:c.projectClaudeSkills},{type:"personal",dir:c.homePersonalSkills},{type:"superpowers",dir:c.homeSuperpowersSkills}]:s=[{type:"project",dir:c.projectAgentsSkills},{type:"claude",dir:c.projectClaudeSkills},{type:"personal",dir:c.homePersonalSkills},{type:"superpowers",dir:c.homeSuperpowersSkills}];for(let{type:n,dir:l}of s){let i=Ze(l,t);if(i.length===1)return{skillFile:i[0].file,sourceType:n,actualSkillPath:i[0].path};i.length>1&&eo(t,i,n)}return null},T=e=>{let o=ns(e);if(o)return o;let{type:t,path:r}=Pe(e),s;t?s=[{type:t,dir:{superpowers:c.homeSuperpowersSkills,claude:c.projectClaudeSkills,project:c.projectAgentsSkills,personal:c.homePersonalSkills}[t]}]:c.isSuperpowersRepo&&Fe(c.projectSkillsDir)?s=[{type:"project",dir:c.projectSkillsDir},{type:"project",dir:c.projectAgentsSkills},{type:"claude",dir:c.projectClaudeSkills},{type:"personal",dir:c.homePersonalSkills},{type:"superpowers",dir:c.homeSuperpowersSkills}]:s=[{type:"project",dir:c.projectAgentsSkills},{type:"claude",dir:c.projectClaudeSkills},{type:"personal",dir:c.homePersonalSkills},{type:"superpowers",dir:c.homeSuperpowersSkills}];for(let{type:n,dir:l}of s){if(!Fe(l))continue;let i=de(l,n,null);for(let d of i){let a=se(d);if(a&&a.aliases&&Array.isArray(a.aliases)){let p=r.toLowerCase();for(let u of a.aliases)if(u.toLowerCase()===p){let h=ts(d,"SKILL.md"),g=rs(l,d);return{skillFile:h,sourceType:n,actualSkillPath:g}}}}}return null};import{readFileSync as oo,writeFileSync as so,existsSync as Le}from"fs";import{join as F}from"path";import{execSync as ls}from"child_process";var ve=()=>({auto_update:!0,last_update_check:null,last_updated_commit:null}),re=()=>{let e=F(c.superpowersRepo,".config.json");try{if(!Le(e))return ve();let o=oo(e,"utf8");return{...ve(),...JSON.parse(o)}}catch{return ve()}},ue=e=>{let o=F(c.superpowersRepo,".config.json"),r={...re(),...e};try{so(o,JSON.stringify(r,null,2))}catch(s){console.log(`Warning: couldn't save config: ${s.message}`)}},me=e=>{let o=e?F(c.home,".agents","config.json"):F(process.cwd(),".agents","config.json");if(!Le(o))return{};try{let t=oo(o,"utf8");return JSON.parse(t)}catch{return{}}},Oe=(e,o)=>{let t=o?F(c.home,".agents"):F(process.cwd(),".agents"),r=F(t,"config.json");try{return Le(t)||ls(`mkdir -p "${t}"`,{stdio:"pipe"}),so(r,JSON.stringify(e,null,2),"utf8"),!0}catch(s){throw new Error(`Failed to write config: ${s.message}`)}},ne=(e=!1)=>me(e).repositories||{},to=(e,o,t)=>{let r=me(t);r.repositories||(r.repositories={}),r.repositories[e]=o,Oe(r,t)};import{readFileSync as is}from"fs";import{join as ro,dirname as as}from"path";import{fileURLToPath as cs}from"url";import{existsSync as ps}from"fs";import{execSync as ds}from"child_process";var us=cs(import.meta.url),no=as(us),P=()=>{try{let e=ro(no,"package.json");return ps(e)||(e=ro(no,"..","..","package.json")),JSON.parse(is(e,"utf8")).version||"5.4.0"}catch{return"5.4.0"}},j=()=>{let e=P();console.log(`^^SAV:${e}^^`)},lo=async()=>{try{let o=ds('curl -sS "https://raw.githubusercontent.com/complexthings/superpowers/main/.agents/package.json"',{encoding:"utf8",timeout:1e4}),t=JSON.parse(o);return t.version?t.version:P()}catch(e){throw new Error(`Failed to fetch remote version: ${e.message}`)}},io=(e,o)=>{let t=e.split(".").map(Number),r=o.split(".").map(Number);for(let s=0;s<3;s++){let n=t[s]||0,l=r[s]||0;if(n>l)return!0;if(n<l)return!1}return!1};var gs={project:{dir:"projectAgentsSkills",prefix:""},claude:{dir:"projectClaudeSkills",prefix:"claude:"},personal:{dir:"homePersonalSkills",prefix:""},superpowers:{dir:"homeSuperpowersSkills",prefix:"superpowers:"}},fs=(e,o)=>{let t=ms(e,"SKILL.md"),{dir:r,prefix:s}=gs[o],n=ao(c[r],e).replace(/\\/g,"/");console.log(`${s}${n}`);let{description:l,whenToUse:i}=oe(t);l&&console.log(`  ${l}`),i&&console.log(`  When to use: ${i}`),console.log("")},G=()=>{j();let e=new Set,o=[{type:"project",dir:c.projectAgentsSkills,maxDepth:null},{type:"claude",dir:c.projectClaudeSkills,maxDepth:null},{type:"personal",dir:c.homePersonalSkills,maxDepth:null},{type:"superpowers",dir:c.homeSuperpowersSkills,maxDepth:null}];for(let{type:t,dir:r,maxDepth:s}of o){let n=de(r,t,s);for(let l of n){let i=ao(r,l);e.has(i)||(e.add(i),fs(l,t))}}console.log(`Usage:
  superpowers-agent execute <skill-name> # Load a specific skill`)},po=()=>{j();let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent execute <skill-name-or-alias>

Examples:
  superpowers-agent execute brainstorming
  superpowers-agent execute superpowers:collaboration/brainstorming
  superpowers-agent execute aem/block-collection-and-party
  superpowers-agent execute block-collection  # Using alias

Description:
  Instructs the agent to execute the specified skill.
  Supports skill aliases defined in skill.json files.`);return}let o=T(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),G();return}let{skillFile:t,sourceType:r}=o,s=process.cwd(),n=t.startsWith(s),l=Ne(c.projectAgentsSkills)||Ne(c.projectClaudeSkills);console.log(n?`Open this file with your Read Tool: ${t}

<IMPORTANT>
USE YOUR Read Tool to process this file. DO NOT use \`cat\` or print commands.
</IMPORTANT>`:l&&r!=="project"?`Open this file with your Read Tool: ${t}

<IMPORTANT>
1. Try using your Read Tool first
2. If your Read tool fails (file outside workspace), use: cat "${t}"
3. Consider using workspace-local skills for better tool compatibility
   Run: superpowers-agent setup-skills
</IMPORTANT>`:`Open this file with your Read Tool: ${t}

<IMPORTANT>
1. Try using your Read Tool first
2. If your Read tool fails (file outside workspace), use: cat "${t}"
3. NEVER skip loading the skill content
</IMPORTANT>`)},uo=()=>{let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent path <skill-name-or-alias>

Examples:
  superpowers-agent path brainstorming
  superpowers-agent path superpowers:collaboration/brainstorming
  superpowers-agent path aem/block-collection-and-party
  superpowers-agent path block-collection  # Using alias

Description:
  Outputs the file system path of the specified SKILL.md file.
  Supports skill aliases defined in skill.json files.`);return}let o=T(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),G();return}let{skillFile:t}=o;console.log(t)},mo=()=>{let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent dir <skill-name>

Examples:
  superpowers-agent dir brainstorming
  superpowers-agent dir aem/block-collection-and-party
  superpowers-agent dir block-collection  # Using alias
  superpowers-agent dir superpowers:testing/test-driven-development

Description:
  Returns the directory path where the specified skill is located.
  Supports skill aliases defined in skill.json files.`);return}let o=T(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),G();return}let{skillFile:t}=o,r=co(t);console.log(r)},go=()=>{j();let e=process.argv[3],o=process.argv[4];if(!e||!o){console.log(`Usage: superpowers-agent get-helpers <skill-name> <helper-search-term>

Examples:
  superpowers-agent get-helpers block-collection search-block
  superpowers-agent get-helpers aem/block-collection-and-party get-block-structure
  superpowers-agent get-helpers superpowers:testing/test-driven-development example

Description:
  Searches for helper files within a skill's skill.json configuration.
  Returns the full path to the best matching helper file.
  
  The command uses the skill's aliases if available, so you can use
  short names like "block-collection" instead of the full path.`);return}let t=T(e);if(!t){console.log(`Error: Skill not found: ${e}

Available skills:`),G();return}let{skillFile:r}=t,s=co(r),n=se(s);if(!n){console.log(`Error: No skill.json found for skill: ${e}
  Location: ${s}`);return}if(!n.helpers||!Array.isArray(n.helpers)||n.helpers.length===0){console.log(`Error: No helpers defined in skill.json for skill: ${e}
  Location: ${s}`);return}let l=qe(s,o);if(!l){console.log(`Error: No helper found matching "${o}" in skill: ${e}`),console.log(`
Available helpers:`);for(let i of n.helpers)console.log(`  - ${i}`);return}if(!Ne(l)){console.log(`Error: Helper file not found: ${l}
  Defined in skill.json but missing from filesystem`);return}console.log(l)},fo=()=>{let e=re();console.log("Current configuration:"),console.log(JSON.stringify(e,null,2))},ho=()=>{let e=process.argv[3],o=process.argv[4];if(!e||o===void 0){console.log(`Usage: .agents/superpowers-agent config-set <key> <value>

Available keys:
  auto_update (true/false) - Enable/disable automatic updates during bootstrap

Examples:
  .agents/superpowers-agent config-set auto_update false
  .agents/superpowers-agent config-set auto_update true`);return}let t=o;o==="true"?t=!0:o==="false"&&(t=!1);let r={};r[e]=t,ue(r),console.log(`\u2713 Set ${e} = ${t}`)};import{execSync as Ps}from"child_process";import{execSync as v}from"child_process";var hs=()=>{try{return v("git status --porcelain --untracked-files=no",{cwd:c.superpowersRepo,encoding:"utf8",stdio:"pipe",timeout:3e3}).trim().length===0}catch{return!1}},le=()=>{try{return v("git rev-parse --abbrev-ref HEAD",{cwd:c.superpowersRepo,encoding:"utf8",stdio:"pipe",timeout:3e3}).trim()==="main"}catch{return!1}},ge=()=>{try{v("git fetch origin",{cwd:c.superpowersRepo,timeout:5e3,stdio:"pipe"});let e=!hs(),o=v("git rev-parse HEAD",{cwd:c.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim(),t=v("git rev-parse origin/main",{cwd:c.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim();if(!(o!==t))return{hasUpdates:!1,hasLocalChanges:e,currentCommit:o,latestCommit:t,commitsBehind:0,changedFiles:[]};let s=parseInt(v("git rev-list --count HEAD..origin/main",{cwd:c.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim(),10),l=v("git diff --name-only HEAD origin/main",{cwd:c.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim().split(`
`).filter(i=>i.length>0);return{hasUpdates:!0,hasLocalChanges:e,currentCommit:o,latestCommit:t,commitsBehind:s,changedFiles:l}}catch{return{hasUpdates:!1,hasLocalChanges:!1,currentCommit:"",latestCommit:"",commitsBehind:0,changedFiles:[],error:!0}}},ko=e=>{let o={".github/prompts/":"copilot-prompts",".github/copilot-instructions.md":"copilot-instructions",".cursor/commands/":"cursor-commands","hooks/cursor/":"cursor-hooks",".codex/prompts/":"codex-prompts",".gemini/commands/":"gemini-commands","commands/":"claude-commands",".opencode/command/":"opencode-commands"},t=new Set;for(let r of e)for(let[s,n]of Object.entries(o))r.startsWith(s)&&t.add(n);return Array.from(t)};import{existsSync as fe,readdirSync as ks}from"fs";import{join as M,dirname as ys}from"path";import{execSync as he}from"child_process";var W=()=>{let e=M(c.superpowersRepo,".github","prompts"),o=M(c.vscodeUserDir,"prompts");if(!fe(e)){console.log("\u26A0\uFE0F  No Copilot prompts to install (source directory not found).");return}try{fe(o)||he(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating prompts directory: ${s.message}`);return}let t;try{t=ks(e).filter(s=>s.endsWith(".prompt.md"))}catch(s){console.log(`Error reading prompts directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No prompt files found to install.");return}console.log("Installing GitHub Copilot prompts...");let r=0;for(let s of t)try{let n=M(e,s),l=M(o,s);he(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),r++}catch(n){console.log(`  \u2717 Failed to install ${s}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} prompt(s) to ${o}
  Use slash commands in GitHub Copilot:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)},_=()=>{let e=M(c.superpowersRepo,".github","copilot-instructions.md"),o=M(c.home,".github","copilot-instructions.md");if(!fe(e)){console.log("\u26A0\uFE0F  No Copilot instructions to install (source file not found).");return}let t=ys(o);try{fe(t)||he(`mkdir -p "${t}"`,{stdio:"pipe"})}catch(r){console.log(`Error creating .github directory: ${r.message}`);return}try{he(`cp "${e}" "${o}"`,{stdio:"pipe"}),console.log(`\u2713 Installed GitHub Copilot universal instructions
  Location: ${o}
  GitHub Copilot will now use Superpowers skills universally in all workspaces`)}catch(r){console.log(`\u2717 Failed to install instructions: ${r.message}`)}};import{existsSync as ke,readdirSync as yo}from"fs";import{join as R}from"path";import{execSync as H}from"child_process";var J=()=>{let e=R(c.superpowersRepo,".cursor","commands"),o=R(c.home,".cursor","commands");if(!ke(e)){console.log("\u26A0\uFE0F  No Cursor commands to install (source directory not found).");return}try{ke(o)||H(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Cursor commands directory: ${s.message}`);return}let t;try{t=yo(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading Cursor commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Cursor commands...");let r=0;for(let s of t)try{let n=R(e,s),l=R(o,s);H(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),r++}catch(n){console.log(`  \u2717 Failed to install ${s}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in Cursor:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)},B=()=>{let e=R(c.superpowersRepo,"hooks","cursor"),o=R(c.home,".cursor","hooks"),t=R(e,"hooks.json"),r=R(c.home,".cursor","hooks.json");if(!ke(e)){console.log("\u26A0\uFE0F  No Cursor hooks to install (source directory not found).");return}try{ke(o)||H(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(l){console.log(`Error creating Cursor hooks directory: ${l.message}`);return}try{H(`cp "${t}" "${r}"`,{stdio:"pipe"}),console.log("  \u2713 Installed hooks.json")}catch(l){console.log(`  \u2717 Failed to install hooks.json: ${l.message}`);return}let s;try{s=yo(e).filter(l=>l.endsWith(".sh"))}catch(l){console.log(`Error reading hooks directory: ${l.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No hook scripts found to install.");return}console.log("Installing Cursor hooks...");let n=0;for(let l of s)try{let i=R(e,l),d=R(o,l);H(`cp "${i}" "${d}"`,{stdio:"pipe"}),H(`chmod +x "${d}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${l}`),n++}catch(i){console.log(`  \u2717 Failed to install ${l}: ${i.message}`)}n>0&&console.log(`
\u2713 Installed ${n} hook(s) to ${o}
  Cursor will now check for skills before each prompt submission
  Restart Cursor for hooks to take effect`)};import{existsSync as wo,readdirSync as ws}from"fs";import{join as ye}from"path";import{execSync as $o}from"child_process";var V=()=>{let e=ye(c.superpowersRepo,".codex","prompts"),o=ye(c.home,".codex","prompts");if(!wo(e)){console.log("\u26A0\uFE0F  No Codex prompts to install (source directory not found).");return}try{wo(o)||$o(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Codex prompts directory: ${s.message}`);return}let t;try{t=ws(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading Codex prompts directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No prompt files found to install.");return}console.log("Installing OpenAI Codex prompts...");let r=0;for(let s of t)try{let n=ye(e,s),l=ye(o,s);$o(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),r++}catch(n){console.log(`  \u2717 Failed to install ${s}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} prompt(s) to ${o}
  Use slash commands in OpenAI Codex:
    /prompts:brainstorm - Refine ideas into designs
    /prompts:write-skill - Create new skills with TDD
    /prompts:skills - Discover available skills
    /prompts:use-skill - Load and apply a specific skill
  Note: Restart Codex or open a new session to reload prompts`)};import{existsSync as So,readdirSync as $s}from"fs";import{join as we}from"path";import{execSync as xo}from"child_process";var K=()=>{let e=we(c.superpowersRepo,".gemini","commands"),o=we(c.home,".gemini","commands");if(!So(e)){console.log("\u26A0\uFE0F  No Gemini commands to install (source directory not found).");return}try{So(o)||xo(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Gemini commands directory: ${s.message}`);return}let t;try{t=$s(e).filter(s=>s.endsWith(".toml"))}catch(s){console.log(`Error reading Gemini commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Gemini commands...");let r=0;for(let s of t)try{let n=we(e,s),l=we(o,s);xo(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),r++}catch(n){console.log(`  \u2717 Failed to install ${s}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in Gemini:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};import{existsSync as Co,readdirSync as Ss}from"fs";import{join as $e}from"path";import{execSync as bo}from"child_process";var Y=()=>{let e=$e(c.superpowersRepo,"commands"),o=$e(c.home,".claude","commands");if(!Co(e)){console.log("\u26A0\uFE0F  No Claude commands to install (source directory not found).");return}try{Co(o)||bo(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating Claude commands directory: ${s.message}`);return}let t;try{t=Ss(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading Claude commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Claude Code commands...");let r=0;for(let s of t)try{let n=$e(e,s),l=$e(o,s);bo(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),r++}catch(n){console.log(`  \u2717 Failed to install ${s}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in Claude Code:
    /brainstorm - Refine ideas into designs
    /execute-plan - Execute plans in batches
    /write-plan - Create implementation plans
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};import{existsSync as Ro,readdirSync as xs}from"fs";import{join as Se}from"path";import{execSync as jo}from"child_process";var z=()=>{let e=Se(c.superpowersRepo,".opencode","command"),o=Se(c.home,".config","opencode","command");if(!Ro(e)){console.log("\u26A0\uFE0F  No opencode commands to install (source directory not found).");return}try{Ro(o)||jo(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(s){console.log(`Error creating opencode commands directory: ${s.message}`);return}let t;try{t=xs(e).filter(s=>s.endsWith(".md"))}catch(s){console.log(`Error reading opencode commands directory: ${s.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing opencode commands...");let r=0;for(let s of t)try{let n=Se(e,s),l=Se(o,s);jo(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${s}`),r++}catch(n){console.log(`  \u2717 Failed to install ${s}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in opencode:
    /brainstorm - Refine ideas into designs
    /execute-plan - Execute plans in batches
    /write-plan - Create implementation plans
    /write-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};import{existsSync as A,readdirSync as Cs,lstatSync as bs,symlinkSync as Do,unlinkSync as Rs,mkdirSync as ie,readlinkSync as js}from"fs";import{join as L,dirname as Ds}from"path";import{homedir as D,platform as Es}from"os";var Eo=[{name:"claude",parentDir:()=>L(D(),".claude"),skillsDir:()=>L(D(),".claude","skills"),superpowersTarget:"superpowers"},{name:"copilot",parentDir:()=>L(D(),".copilot"),skillsDir:()=>L(D(),".copilot","skills"),superpowersTarget:"superpowers"}],Ge=e=>{try{return bs(e).isSymbolicLink()}catch{return!1}},Us=(e,o)=>{try{return Ge(e)?js(e)===o:!1}catch{return!1}},Uo=(e,o)=>{if(!A(e))return{created:!1,existed:!1,error:`Source does not exist: ${e}`};if(Us(o,e))return{created:!1,existed:!0};if(A(o)||Ge(o))if(Ge(o))try{Rs(o)}catch(s){return{created:!1,existed:!1,error:`Failed to remove existing symlink: ${s.message}`}}else return{created:!1,existed:!1,error:`Target exists and is not a symlink: ${o}`};let t=Ds(o);if(!A(t))try{ie(t,{recursive:!0})}catch(s){return{created:!1,existed:!1,error:`Failed to create parent directory: ${s.message}`}}let r=Es();try{return r==="win32"?Do(e,o,"junction"):Do(e,o,"dir"),{created:!0,existed:!1}}catch(s){return r==="win32"&&s.code==="EPERM"?{created:!1,existed:!1,error:"Windows requires Developer Mode or admin privileges for symlinks. Enable Developer Mode: Settings > Update & Security > For developers"}:{created:!1,existed:!1,error:`Failed to create symlink: ${s.message}`}}};var Io=(e,o,t="skills")=>{let r=me(!0);if(r.symlinks||(r.symlinks={}),r.symlinks[e]||(r.symlinks[e]={superpowers:null,skills:[]}),t==="superpowers")r.symlinks[e].superpowers=o;else{let s=r.symlinks[e].skills||[];s.includes(o)||(s.push(o),r.symlinks[e].skills=s)}Oe(r,!0)};var Is=(e,o={})=>{let t=c.homeSuperpowersSkills,r=L(e.skillsDir(),e.superpowersTarget),s=Uo(t,r);if(s.created){Io(e.name,r,"superpowers");let n=t.replace(D(),"~"),l=r.replace(D(),"~");return console.log(`  \u2713 Created ${l} -> ${n}`),{created:!0}}else{if(s.existed)return{created:!1,existed:!0};if(s.error)return console.log(`  \u26A0\uFE0F  ${e.name} superpowers: ${s.error}`),{created:!1,error:s.error}}return{created:!1}},Po=(e,o={})=>{let t=c.homePersonalSkills;if(!A(t))return{created:0,existed:0};let r;try{r=Cs(t,{withFileTypes:!0}).filter(n=>n.isDirectory()&&!n.name.startsWith(".")).map(n=>n.name)}catch{return{created:0,existed:0}}if(r.length===0)return{created:0,existed:0};let s={created:0,existed:0,names:[]};for(let n of r){let l=L(t,n),i=L(e.skillsDir(),n),d=Uo(l,i);d.created?(Io(e.name,i,"skills"),s.created++,s.names.push(n)):d.existed?s.existed++:d.error&&console.log(`  \u26A0\uFE0F  ${n}: ${d.error}`)}return s.created>0&&console.log(`  \u2713 Synced ${s.created} personal skill(s): ${s.names.join(", ")}`),s},xe=(e={})=>{let{force:o=!1}=e;for(let t of Eo){let r=t.parentDir(),s=t.skillsDir();if(!A(r))if(o)try{ie(r,{recursive:!0}),console.log(`\u2713 Created ${r.replace(D(),"~")}`)}catch(n){console.log(`\u26A0\uFE0F  Failed to create ${r.replace(D(),"~")}: ${n.message}`);continue}else{console.log(`\u26A0\uFE0F  Skipping ${t.name} (${r.replace(D(),"~")} not found)`),console.log("   Use --force to create directory");continue}if(!A(s))try{ie(s,{recursive:!0})}catch(n){console.log(`\u26A0\uFE0F  Failed to create skills directory for ${t.name}: ${n.message}`);continue}console.log(`${t.name}:`),Is(t,e),Po(t,e)}},Me=(e={})=>{let{force:o=!1}=e;for(let t of Eo){let r=t.parentDir(),s=t.skillsDir();if(!A(r)){if(!o)continue;try{ie(r,{recursive:!0})}catch{continue}}if(!A(s))try{ie(s,{recursive:!0})}catch{continue}Po(t,e)}};var As=e=>{let t={"copilot-prompts":W,"copilot-instructions":_,"cursor-commands":J,"cursor-hooks":B,"codex-prompts":V,"gemini-commands":K,"claude-commands":Y,"opencode-commands":z}[e];if(t)try{return t(),{success:!0,integration:e}}catch(r){return{success:!1,integration:e,error:r.message}}return{success:!1,integration:e,error:"Unknown integration"}},Ts=()=>{console.log("Installing aliases...")},Ce=(e={})=>{let o=e.skipReinstall||!1;console.log(`# Checking for Superpowers updates...
`);let t=ge();if(t.error){console.log("\u26A0\uFE0F  Could not check for updates (network issue)");return}if(!t.hasUpdates){console.log("\u2713 Already up to date");return}if(t.hasLocalChanges){console.log(`\u26A0\uFE0F  Cannot auto-update: local changes detected
   Commit or stash your changes first, then run update again
   Or manually update: cd ${c.superpowersRepo} && git pull`);return}if(!le()){console.log(`\u26A0\uFE0F  Not on main branch, skipping auto-update
   Switch to main branch first: cd ${c.superpowersRepo} && git checkout main`);return}console.log(`\u{1F4E6} Updating from ${t.currentCommit.substring(0,7)} to ${t.latestCommit.substring(0,7)}
   (${t.commitsBehind} new commit${t.commitsBehind>1?"s":""})
`);try{Ps("git pull origin main",{cwd:c.superpowersRepo,stdio:"pipe",timeout:1e4}),console.log("\u2713 Updated superpowers repository")}catch(l){console.log(`\u2717 Git pull failed: ${l.message}
   Please resolve manually and try again`);return}if(console.log(""),ue({last_updated_commit:t.latestCommit,last_update_check:new Date().toISOString()}),o){console.log(`\u2139\uFE0F  Skipping integration reinstall (--no-reinstall flag)

\u2713 Update complete!`);return}let r=ko(t.changedFiles);if(r.length===0){console.log(`\u2139\uFE0F  No integration files changed, skipping reinstalls

\u2713 Update complete!`);return}console.log(`\u{1F504} Reinstalling updated integrations:
`);let s=[];for(let l of r){let i=As(l);s.push(i),i.success?console.log(`  \u2713 ${l}`):console.log(`  \u2717 ${l} (${i.error})`)}console.log(""),console.log(`
---
`),Ts(),console.log(`
---
`),console.log(`## Syncing Skill Symlinks
`),xe();let n=s.filter(l=>!l.success);if(n.length>0){console.log("\u26A0\uFE0F  Update completed with errors:");for(let l of n){console.log(`  - ${l.integration} failed to install`);let i=`install-${l.integration}`;console.log(`    Run manually: superpowers-agent ${i}`)}}else console.log("\u2713 Update complete!")},Ao=async()=>{j();let e=P();console.log(`Current version: ${e}`);try{let o=await lo();console.log(`Latest version: ${o}`),io(o,e)?(console.log("Update available: Yes"),process.exit(1)):(console.log("You are up to date"),process.exit(0))}catch(o){console.log(`Error checking for updates: ${o.message}`),process.exit(1)}},To=()=>{let e=P();console.log(e)};import{existsSync as f,readFileSync as be,writeFileSync as vo}from"fs";import{join as k,dirname as vs,parse as ce}from"path";import{execSync as b}from"child_process";import{platform as Ls}from"os";import{execSync as Fs}from"child_process";var ae=e=>{try{return Fs(`which ${e}`,{stdio:"pipe",timeout:2e3}),!0}catch{return!1}};var m={opencode:{check:()=>ae("opencode"),cli:!0,name:"OpenCode",installUrl:"https://opencode.ai/docs/installation",bootstrapCommand:"install-opencode-commands"},claude:{check:()=>ae("claude"),cli:!0,name:"Claude Code",installUrl:"https://code.claude.com/docs/en/installation",bootstrapCommand:"install-claude-commands"},gemini:{check:()=>ae("gemini"),cli:!0,name:"Gemini",installUrl:"https://cloud.google.com/gemini/docs/cli/install",bootstrapCommand:"install-gemini-commands"},codex:{check:()=>ae("codex"),cli:!0,name:"Codex",installUrl:"https://developers.openai.com/codex/docs/installation",bootstrapCommand:"install-codex-prompts"},cursor:{check:()=>!0,cli:!1,name:"Cursor",bootstrapCommand:"install-cursor-commands"},copilot:{check:()=>!0,cli:!1,name:"GitHub Copilot",bootstrapCommand:"install-copilot-prompts"}},Fo=()=>{let e=[];return m.copilot.check()&&e.push("github-copilot"),m.cursor.check()&&e.push("cursor"),m.claude.check()&&e.push("claude-code"),m.opencode.check()&&e.push("opencode"),m.gemini.check()&&e.push("gemini"),m.codex.check()&&e.push("codex"),e};var Os=e=>{let o={"github-copilot":"TOOLS-GITHUB-COPILOT.md.template",cursor:"TOOLS-CURSOR.md.template","claude-code":"TOOLS-CLAUDE-CODE.md.template",gemini:"TOOLS-GEMINI.md.template",opencode:"TOOLS-OPENCODE.md.template",codex:"TOOLS-CODEX.md.template"},t=k(c.superpowersRepo,".agents","templates"),r=[];for(let s of e){let n=o[s];if(!n)continue;let l=k(t,n);if(f(l))try{let i=be(l,"utf8").trim();r.push(i)}catch{let d={"github-copilot":"GitHub Copilot",cursor:"Cursor","claude-code":"Claude Code",opencode:"OpenCode",gemini:"Gemini",codex:"Codex"};r.push(`**Tool Mapping for ${d[s]}:**`)}}return r.join(`
`)},pe=(e,o,t,r=!0)=>{let s=f(e);if(!s&&!r)return{updated:!1,created:!1,skipped:!0};let n=Os(t),l=o.replace(/\{\{TOOL_MAPPINGS\}\}/g,n),i=new Date().toISOString().split("T")[0];l=l.replace(/\{\{DATE\}\}/g,i),l=l.replace(/\{\{SUPERPOWERS_PATH\}\}/g,c.superpowersRepo);let d=`<!-- SUPERPOWERS_SKILLS_START -->
${l}
<!-- SUPERPOWERS_SKILLS_END -->`;if(s){let a=new Date().toISOString().split("T")[0],p=`${e}.backup-${a}`;try{b(`cp "${e}" "${p}"`,{stdio:"pipe"})}catch(y){return{updated:!1,error:!0,message:`Failed to backup: ${y.message}`}}let u;try{u=be(e,"utf8")}catch(y){return{updated:!1,error:!0,message:`Failed to read: ${y.message}`}}let h="<!-- SUPERPOWERS_SKILLS_START -->",g="<!-- SUPERPOWERS_SKILLS_END -->",S;if(u.includes(h)&&u.includes(g)){let y=new RegExp(`${h}[\\s\\S]*?${g}`,"g");S=u.replace(y,d)}else{let y=u.match(/^#\s+.+$/m);if(y){let X=u.indexOf(`
`,y.index)+1;S=u.slice(0,X)+`
`+d+`
`+u.slice(X)}else S=d+`

`+u}try{return vo(e,S,"utf8"),{updated:!0,created:!1,backup:p}}catch(y){return{updated:!1,error:!0,message:`Failed to write: ${y.message}`}}}else try{let a=vs(e);f(a)||b(`mkdir -p "${a}"`,{stdio:"pipe"});let h=`# ${ce(e).base.toUpperCase()}

`+d;return vo(e,h,"utf8"),{updated:!1,created:!0}}catch(a){return{updated:!1,created:!1,error:!0,message:`Failed to create: ${a.message}`}}},Ns=()=>{console.log("Installing Unix aliases...");let e=k(c.superpowersRepo,".agents","superpowers-agent"),o=k(c.home,".local","bin"),t=k(o,"superpowers-agent"),r=k(o,"superpowers");if(!f(e)){console.log("\u26A0\uFE0F  superpowers-agent executable not found");return}if(!f(o))try{b(`mkdir -p "${o}"`,{stdio:"pipe"}),console.log(`\u2713 Created ${o}`)}catch(n){console.log(`\u26A0\uFE0F  Failed to create ${o}: ${n.message}`);return}try{f(t)&&b(`rm "${t}"`,{stdio:"pipe"}),b(`ln -s "${e}" "${t}"`,{stdio:"pipe"}),console.log(`\u2713 Created symlink: superpowers-agent -> ${e}`)}catch(n){console.log(`\u26A0\uFE0F  Failed to create superpowers-agent symlink: ${n.message}`)}try{f(r)&&b(`rm "${r}"`,{stdio:"pipe"}),b(`ln -s "${e}" "${r}"`,{stdio:"pipe"}),console.log(`\u2713 Created symlink: superpowers -> ${e}`)}catch(n){console.log(`\u26A0\uFE0F  Failed to create superpowers symlink: ${n.message}`)}(process.env.PATH||"").includes(o)||(console.log(`
\u26A0\uFE0F  Warning: ${o} is not in your PATH`),console.log("   Add this to your shell profile (~/.bashrc, ~/.zshrc, etc.):"),console.log(`   export PATH="$HOME/.local/bin:$PATH"
`))},Gs=()=>{console.log("Installing Windows aliases..."),console.log("\u2713 Windows alias installation (implementation pending)")},We=()=>{let e=Ls();return console.log(`## Installing Universal Aliases
`),e==="win32"?Gs():Ns()},Lo=()=>{j(),console.log(`# Setting up Superpowers skills for this project
`);let e=process.cwd(),o=k(e,".agents"),t=k(o,"skills"),r=k(e,"AGENTS.md"),s=k(o,"AGENTS.md"),n=f(r)?r:s,l=k(c.superpowersRepo,".agents","templates","AGENTS.md.template");if(!f(l)){console.log(`\u2717 Error: AGENTS.md template not found
  Expected at: ${l}
  Please update your Superpowers installation`);return}if(f(o))console.log("\u2713 .agents/ directory exists");else try{b(`mkdir -p "${o}"`,{stdio:"pipe"}),console.log("\u2713 Created .agents/ directory")}catch(x){console.log(`\u2717 Failed to create .agents/ directory: ${x.message}`);return}if(f(t))console.log("\u2713 .agents/skills/ directory exists");else try{b(`mkdir -p "${t}"`,{stdio:"pipe"}),b(`touch "${k(t,".gitkeep")}"`,{stdio:"pipe"}),console.log("\u2713 Created .agents/skills/ directory")}catch(x){console.log(`\u2717 Failed to create skills directory: ${x.message}`);return}let i=f(n);if(i){let x=new Date().toISOString().split("T")[0],Je=`${n}.backup-${x}`;try{b(`cp "${n}" "${Je}"`,{stdio:"pipe"}),console.log(`\u2713 Backed up existing AGENTS.md to ${ce(Je).base}`)}catch(Yo){console.log(`\u2717 Failed to backup AGENTS.md: ${Yo.message}`);return}}let d;try{d=be(l,"utf8")}catch(x){console.log(`\u2717 Failed to read template: ${x.message}`);return}let a=P();d=d.replace(/\{\{VERSION\}\}/g,a);let p=[],u=k(e,".github","copilot-instructions.md"),h=k(c.home,".github","copilot-instructions.md");(f(u)||f(h)||m.copilot.check())&&p.push("github-copilot");let g=k(e,"CLAUDE.md"),S=k(o,"CLAUDE.md");(f(g)||f(S)||m.claude.check())&&p.push("claude-code");let y=k(e,"GEMINI.md"),X=k(o,"GEMINI.md");(f(y)||f(X)||m.gemini.check())&&p.push("gemini"),m.cursor.check()&&p.push("cursor"),m.opencode.check()&&p.push("opencode"),m.codex.check()&&p.push("codex"),console.log(`
Detected platforms for project: ${p.join(", ")||"none"}
`);let Ko=p.filter(x=>["github-copilot","cursor","opencode","codex"].includes(x)),Q=pe(n,d,Ko,!i);Q.created?console.log(`\u2713 Created AGENTS.md with platform tool mappings (${n===r?"root":".agents/"})`):Q.updated?console.log(`\u2713 Updated AGENTS.md with platform tool mappings (${n===r?"root":".agents/"})`):Q.error&&console.log("\u26A0\uFE0F  Failed to update AGENTS.md");let Ee=f(g)?g:S,U=pe(Ee,d,["claude-code"],!1);U.created?console.log(`\u2713 Created CLAUDE.md with Claude Code tool mappings (${Ee===g?"root":".agents/"})`):U.updated?(console.log(`\u2713 Updated CLAUDE.md with Claude Code tool mappings (${Ee===g?"root":".agents/"})`),U.backup&&console.log(`  Backed up to ${ce(U.backup).base}`)):U.skipped?console.log("\u2139\uFE0F  Skipped CLAUDE.md (does not exist)"):U.error&&console.log("\u26A0\uFE0F  Failed to update CLAUDE.md");let Ue=f(y)?y:X,I=pe(Ue,d,["gemini"],!1);I.created?console.log(`\u2713 Created GEMINI.md with Gemini tool mappings (${Ue===y?"root":".agents/"})`):I.updated?(console.log(`\u2713 Updated GEMINI.md with Gemini tool mappings (${Ue===y?"root":".agents/"})`),I.backup&&console.log(`  Backed up to ${ce(I.backup).base}`)):I.skipped?console.log("\u2139\uFE0F  Skipped GEMINI.md (does not exist)"):I.error&&console.log("\u26A0\uFE0F  Failed to update GEMINI.md");let Ie=k(e,".github","copilot-instructions.md"),He=!f(r)&&!f(s),O={skipped:!0};f(Ie)&&He?(O=pe(Ie,d,["github-copilot"],!1),O.updated?(console.log("\u2713 Updated .github/copilot-instructions.md with GitHub Copilot tool mappings"),O.backup&&console.log(`  Backed up to ${ce(O.backup).base}`)):O.error&&console.log("\u26A0\uFE0F  Failed to update .github/copilot-instructions.md")):f(Ie)&&!He?console.log("\u2139\uFE0F  Skipped .github/copilot-instructions.md (AGENTS.md exists, using that instead)"):console.log("\u2139\uFE0F  Skipped .github/copilot-instructions.md (does not exist)");let N=`
# Setup complete!

Your project now has:
  - .agents/ directory structure`;(Q.updated||Q.created)&&(N+=`
  - AGENTS.md with universal skills instructions`),(U.updated||U.created)&&(N+=`
  - CLAUDE.md with Claude Code skills instructions`),(I.updated||I.created)&&(N+=`
  - GEMINI.md with Gemini skills instructions`),O.updated&&(N+=`
  - .github/copilot-instructions.md with GitHub Copilot skills instructions`),N+=`
  - .agents/skills/ ready for project-specific skills
`,console.log(N)},Oo=()=>{if(j(),console.log(`# Superpowers Bootstrap for Agents
# ==================================
`),!process.argv.includes("--no-update")){let a=re(),p=ge();p.error?console.log(`## Update Check

\u26A0\uFE0F  Could not check for updates (network issue)

---
`):p.hasUpdates&&(a.auto_update&&!p.hasLocalChanges&&le()?(console.log(`## Auto-Update
`),Ce(),console.log(`
---
`)):(console.log(`## Update Available
`),p.hasLocalChanges?console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    Cannot auto-update: local changes detected\n    To update, commit/stash changes then run: `superpowers-agent update`"):le()?console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    To update, run: `superpowers-agent update`\n    Or enable auto-update: `superpowers-agent config-set auto_update true`"):console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    Cannot auto-update: not on main branch\n    To update, switch to main then run: `superpowers-agent update`"),console.log(`
---
`)))}We(),console.log(`---
`),console.log(`## GitHub Copilot Integration
`),W(),console.log(""),_(),console.log(`
---
`),console.log(`## Cursor Integration
`),J(),console.log(""),B(),console.log(`
---
`),console.log(`## OpenAI Codex Integration
`),m.codex.check()?V():console.log(`\u26A0\uFE0F  Skipped (${m.codex.name} CLI not detected)
\u{1F4A1} To enable Codex integration:
   1. Install Codex: ${m.codex.installUrl}
   2. Run: superpowers-agent ${m.codex.bootstrapCommand}`),console.log(`
---
`),console.log(`## Gemini Integration
`),m.gemini.check()?K():console.log(`\u26A0\uFE0F  Skipped (${m.gemini.name} CLI not detected)
\u{1F4A1} To enable Gemini integration:
   1. Install Gemini: ${m.gemini.installUrl}
   2. Run: superpowers-agent ${m.gemini.bootstrapCommand}`),console.log(`
---
`),console.log(`## Claude Code Integration
`),m.claude.check()?Y():console.log(`\u26A0\uFE0F  Skipped (${m.claude.name} CLI not detected)
\u{1F4A1} To enable Claude Code integration:
   1. Install Claude Code: ${m.claude.installUrl}
   2. Run: superpowers-agent ${m.claude.bootstrapCommand}`),console.log(`
---
`),console.log(`## OpenCode Integration
`),m.opencode.check()?z():console.log(`\u26A0\uFE0F  Skipped (${m.opencode.name} CLI not detected)
\u{1F4A1} To enable OpenCode integration:
   1. Install OpenCode: ${m.opencode.installUrl}
   2. Run: superpowers-agent ${m.opencode.bootstrapCommand}`),console.log(`
---
`),console.log(`## Generating Platform-Specific Files
`);let n=Fo();console.log(`Detected platforms: ${n.join(", ")||"none"}
`);let l=k(c.superpowersRepo,".agents","templates","AGENTS.md.template"),i="";try{i=be(l,"utf8")}catch(a){console.log(`\u26A0\uFE0F  Could not read AGENTS.md template: ${a.message}
`)}if(i){let a=P();i=i.replace(/\{\{VERSION\}\}/g,a);let p=k(c.home,".agents","AGENTS.md"),u=pe(p,i,n,!0);u.created?console.log(`\u2713 Created ${p}`):u.updated&&console.log(`\u2713 Updated ${p}`)}console.log(`
---
`),console.log(`## Syncing Skill Symlinks
`);let d=process.argv.includes("--force");xe({force:d}),console.log(`
---
`),console.log(`# Bootstrap Complete!
`),console.log("\u2713 All integrations installed"),console.log("\u2713 Skills system ready"),console.log(`\u2713 Skill symlinks synced
`),console.log("Next steps:"),console.log("  - Run `superpowers-agent find-skills` to see available skills"),console.log("  - Run `superpowers-agent setup-skills` in your project directory")};import{existsSync as E,readFileSync as No}from"fs";import{join as $,dirname as _e,parse as Re}from"path";import{execSync as C}from"child_process";import{homedir as q}from"os";var Go=e=>{let o=e.match(/^https:\/\/github\.com\/([^/]+)\/([^/]+)\/tree\/([^/]+)\/(.+)$/);if(o){let[,s,n,l,i]=o;return{type:"git-tree",repoUrl:`https://github.com/${s}/${n}.git`,branch:l,path:i,original:e}}let t=e.match(/^git@github\.com:([^/]+)\/([^/]+?)(?:\.git)?$/);if(t){let[,s,n]=t;return{type:"git-repo",repoUrl:`git@github.com:${s}/${n}.git`,branch:null,path:null,original:e}}let r=e.match(/^https:\/\/github\.com\/([^/]+)\/([^/]+)(?:\.git)?$/);if(r){let[,s,n]=r;return{type:"git-repo",repoUrl:`https://github.com/${s}/${n}.git`,branch:null,path:null,original:e}}return E(e)?{type:"local",path:e,original:e}:null},Mo=e=>{let o=e.includes("--global")||e.includes("-g"),t=e.includes("--project")||e.includes("-p");if(o)return $(q(),".agents","skills");if(t)return $(process.cwd(),".agents","skills");let r=$(process.cwd(),".agents","config.json"),s=$(q(),".agents","config.json");for(let n of[r,s])if(E(n))try{if(JSON.parse(No(n,"utf8")).installLocation==="project")return $(process.cwd(),".agents","skills")}catch{}return $(q(),".agents","skills")},Wo=(e,o)=>{let t=$(q(),".agents","tmp",`skill-install-${Date.now()}`);try{return C(`mkdir -p "${t}"`,{stdio:"pipe"}),o?C(`git clone --branch ${o} --depth 1 "${e}" "${t}"`,{stdio:"pipe",timeout:3e4}):C(`git clone --depth 1 "${e}" "${t}"`,{stdio:"pipe",timeout:3e4}),t}catch(r){try{C(`rm -rf "${t}"`,{stdio:"pipe"})}catch{}throw new Error(`Failed to clone repository: ${r.message}`)}},De=e=>{let o=$(e,"skill.json");if(!E(o))return null;try{let t=No(o,"utf8");return JSON.parse(t)}catch(t){throw new Error(`Failed to read skill.json: ${t.message}`)}},je=(e,o,t,r)=>{let s=$(e,o);if(!E(s)){r.errors.push(`Skill directory not found: ${o}`);return}let n=De(s);if(!n){r.errors.push(`No skill.json found in: ${o}`);return}let l=n.name||o,i=$(t,l),d=_e(i);try{C(`mkdir -p "${d}"`,{stdio:"pipe"})}catch(a){r.errors.push(`Failed to create directory ${d}: ${a.message}`);return}try{E(i)&&C(`rm -rf "${i}"`,{stdio:"pipe"}),C(`cp -R "${s}" "${i}"`,{stdio:"pipe"}),r.installed.push({name:l,path:i,title:n.title||n.description||l})}catch(a){r.errors.push(`Failed to install ${o}: ${a.message}`)}},_o=()=>{let e=process.argv.slice(3),o=e.find(a=>!a.startsWith("-")),t=e.filter(a=>a.startsWith("-"));if(!o){console.log(`Usage: superpowers-agent add <url-or-path|@alias> [skill-path] [options]

Options:
  --global, -g   Install skills globally in ~/.agents/skills/ (default)
  --project, -p  Install skills in current project's .agents/skills/

Examples:
  superpowers-agent add https://github.com/example/skills
  superpowers-agent add https://github.com/example/repo/tree/main/skills
  superpowers-agent add ~/my-local-skills
  superpowers-agent add https://github.com/example/skills --project
  superpowers-agent add ~/my-local-skills --global
  superpowers-agent add @myrepo path/to/skill
  superpowers-agent add @myrepo path/to/skills --project

Description:
  Installs skill(s) from a Git repository, local directory, or repository alias.
  Supports repositories with single or multiple skills.
  Reads skill.json to determine skill names and installation paths.
  
  Repository aliases can be added using:
    superpowers-agent add-repository <git-url> [--as=@alias]`);return}console.log(`Installing skill(s)...
`);let r=null,s=null;if(o.startsWith("@")){let a=o;s=e.find((g,S)=>S>0&&!g.startsWith("-")&&g!==a);let p=ne(!1),u=ne(!0);if(p[a])r=p[a],console.log(`Using project repository alias: ${a}`);else if(u[a])r=u[a],console.log(`Using global repository alias: ${a}`);else{console.log(`Error: Repository alias not found: ${a}`),console.log(`
Available aliases:`);let g={...u,...p};if(Object.keys(g).length===0)console.log("  (none)"),console.log(`
Add a repository using:`),console.log("  superpowers-agent add-repository <git-url>");else for(let[S,y]of Object.entries(g))console.log(`  ${S} -> ${y}`);return}let h=E(r);s?h?(o=$(r,s),console.log(`Repository path: ${r}`),console.log(`Skill path: ${s}
`)):(o=`${r}/tree/main/${s}`,console.log(`Repository URL: ${r}`),console.log(`Skill path: ${s}
`)):(o=r,console.log(h?`Repository path: ${r}
`:`Repository URL: ${r}
`))}let n=Go(o);if(!n){console.log(`Error: Invalid URL or path not found: ${o}`);return}let l=Mo(t);console.log(`Install location: ${l}
`);let i,d=!1;try{if(n.type==="git-repo"||n.type==="git-tree"){if(console.log(`Cloning repository: ${n.repoUrl}`),n.branch&&console.log(`Branch: ${n.branch}`),i=Wo(n.repoUrl,n.branch),d=!0,n.path&&(i=$(i,n.path),!E(i)))throw new Error(`Path not found in repository: ${n.path}`);console.log("")}else i=n.path;let a=De(i);if(!a)throw new Error("No skill.json found in source directory");let p={installed:[],errors:[],source:n.original};if(a.skills&&Array.isArray(a.skills)){console.log(`Found ${a.skills.length} skill(s) to install
`);for(let u of a.skills)je(i,u,l,p)}else{let u=a.name||Re(i).base;je(_e(i),Re(i).base,l,p)}if(d&&i)try{let u=i.split("/.agents/tmp/")[0]+"/.agents/tmp/"+i.split("/.agents/tmp/")[1].split("/")[0];C(`rm -rf "${u}"`,{stdio:"pipe"})}catch{}if(console.log(`
**Successfully installed skills:**`),console.log(`- Source: ${p.source}`),p.installed.length>0)for(let u of p.installed)console.log(`  - Installed: ${u.name} at ${u.path}`),console.log(`    ${u.title}`);if(p.errors.length>0){console.log(`
**Errors:**`);for(let u of p.errors)console.log(`  - ${u}`)}p.installed.length===0&&p.errors.length===0&&console.log("  No skills were installed"),p.installed.length>0&&(console.log(`
**Syncing skill symlinks...**`),Me())}catch(a){if(d&&i)try{let p=i.split("/.agents/tmp/")[0]+"/.agents/tmp/"+i.split("/.agents/tmp/")[1].split("/")[0];C(`rm -rf "${p}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${a.message}`)}},Ho=()=>{let e=process.argv.slice(3),o=e.find(a=>!a.startsWith("-")),t=e.filter(a=>a.startsWith("-"));if(!o){console.log(`Usage: superpowers-agent pull <url-or-path|@alias> [skill-path] [options]

Options:
  --global, -g   Update skills globally in ~/.agents/skills/ (default)
  --project, -p  Update skills in current project's .agents/skills/

Examples:
  superpowers-agent pull https://github.com/example/skills
  superpowers-agent pull https://github.com/example/repo/tree/main/skills
  superpowers-agent pull ~/my-local-skills
  superpowers-agent pull https://github.com/example/skills --project
  superpowers-agent pull ~/my-local-skills --global
  superpowers-agent pull @myrepo
  superpowers-agent pull @myrepo path/to/skill
  superpowers-agent pull @myrepo path/to/skills --project

Description:
  Updates or adds skill(s) from a Git repository, local directory, or repository alias.
  If skills already exist, they will be updated (replaced).
  If skills don't exist, they will be added.
  Supports repositories with single or multiple skills.
  Reads skill.json to determine skill names and installation paths.
  
  Repository aliases can be added using:
    superpowers-agent add-repository <git-url> [--as=@alias]`);return}console.log(`Updating skill(s)...
`);let r=null,s=null;if(o.startsWith("@")){let a=o;s=e.find((g,S)=>S>0&&!g.startsWith("-")&&g!==a);let p=ne(!1),u=ne(!0);if(p[a])r=p[a],console.log(`Using project repository alias: ${a}`);else if(u[a])r=u[a],console.log(`Using global repository alias: ${a}`);else{console.log(`Error: Repository alias not found: ${a}`),console.log(`
Available aliases:`);let g={...u,...p};if(Object.keys(g).length===0)console.log("  (none)"),console.log(`
Add a repository using:`),console.log("  superpowers-agent add-repository <git-url>");else for(let[S,y]of Object.entries(g))console.log(`  ${S} -> ${y}`);return}let h=E(r);s?h?(o=$(r,s),console.log(`Repository path: ${r}`),console.log(`Skill path: ${s}
`)):(o=`${r}/tree/main/${s}`,console.log(`Repository URL: ${r}`),console.log(`Skill path: ${s}
`)):(o=r,console.log(h?`Repository path: ${r}
`:`Repository URL: ${r}
`))}let n=Go(o);if(!n){console.log(`Error: Invalid URL or path not found: ${o}`);return}let l=Mo(t);console.log(`Install location: ${l}
`);let i,d=!1;try{if(n.type==="git-repo"||n.type==="git-tree"){if(console.log(`Cloning repository: ${n.repoUrl}`),n.branch&&console.log(`Branch: ${n.branch}`),i=Wo(n.repoUrl,n.branch),d=!0,n.path&&(i=$(i,n.path),!E(i)))throw new Error(`Path not found in repository: ${n.path}`);console.log("")}else i=n.path;let a=De(i);if(!a)throw new Error("No skill.json found in source directory");let p={installed:[],errors:[],source:n.original};if(a.skills&&Array.isArray(a.skills)){console.log(`Found ${a.skills.length} skill(s) to update
`);for(let u of a.skills)je(i,u,l,p)}else{let u=a.name||Re(i).base;je(_e(i),Re(i).base,l,p)}if(d&&i)try{let u=i.split("/.agents/tmp/")[0]+"/.agents/tmp/"+i.split("/.agents/tmp/")[1].split("/")[0];C(`rm -rf "${u}"`,{stdio:"pipe"})}catch{}if(console.log(`
**Successfully updated skills:**`),console.log(`- Source: ${p.source}`),p.installed.length>0)for(let u of p.installed)console.log(`  - Updated: ${u.name} at ${u.path}`),console.log(`    ${u.title}`);if(p.errors.length>0){console.log(`
**Errors:**`);for(let u of p.errors)console.log(`  - ${u}`)}p.installed.length===0&&p.errors.length===0&&console.log("  No skills were updated"),p.installed.length>0&&(console.log(`
**Syncing skill symlinks...**`),Me())}catch(a){if(d&&i)try{let p=i.split("/.agents/tmp/")[0]+"/.agents/tmp/"+i.split("/.agents/tmp/")[1].split("/")[0];C(`rm -rf "${p}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${a.message}`)}},Jo=()=>{let e=process.argv.slice(3),o=e.find(a=>!a.startsWith("-")),t=e.filter(a=>a.startsWith("-"));if(!o){console.log(`Usage: superpowers-agent add-repository <git-url> [options]

Options:
  --global, -g        Add repository globally in ~/.agents/config.json (default)
  --project, -p       Add repository in current project's .agents/config.json
  --as=<alias>        Specify custom alias for the repository

Examples:
  superpowers-agent add-repository https://github.com/example/skills.git
  superpowers-agent add-repository https://github.com/example/skills.git --as=@myskills
  superpowers-agent add-repository https://github.com/example/skills.git --project
  superpowers-agent add-repository https://github.com/example/skills.git --as=@custom --global

Description:
  Adds a skill repository alias to your configuration.
  The repository's skill.json will be read to determine the default alias.
  Use --as to specify a custom alias.
  After adding, you can install skills using: superpowers-agent add @alias path/to/skill`);return}console.log(`Adding repository...
`);let r=t.some(a=>a==="--global"||a==="-g"),s=t.some(a=>a==="--project"||a==="-p"),n=t.find(a=>a.startsWith("--as=")),l=n?n.split("=")[1]:null,i=!s,d;try{console.log(`Cloning repository: ${o}`),d=$(q(),".agents","tmp",`repo-add-${Date.now()}`),C(`mkdir -p "${d}"`,{stdio:"pipe"}),C(`git clone --depth 1 "${o}" "${d}"`,{stdio:"pipe",timeout:3e4}),console.log("");let a=De(d);if(!a)throw new Error("No skill.json found in repository");let p;if(l)p=l;else if(a.repository)p=a.repository;else{let g=o.match(/\/([^/]+?)(?:\.git)?$/);if(g)p="@"+g[1];else throw new Error("Could not determine repository alias. Use --as=@alias to specify manually.")}to(p,o,i),C(`rm -rf "${d}"`,{stdio:"pipe"});let u=i?"globally":"in project",h=i?$(q(),".agents","config.json"):$(process.cwd(),".agents","config.json");console.log(`\u2713 Repository added ${u}`),console.log(`  Alias: ${p}`),console.log(`  URL: ${o}`),console.log(`  Config: ${h}`),console.log(`
You can now install skills using:`),console.log(`  superpowers-agent add ${p} <path-to-skill>`)}catch(a){if(d)try{C(`rm -rf "${d}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${a.message}`)}};import{dirname as Ms}from"path";var Bo=e=>{if(!e){console.log(`Usage: superpowers-agent use-skill <skill-name>

Examples (smart matching):
  superpowers-agent use-skill brainstorming              # Matches superpowers:collaboration/brainstorming
  superpowers-agent use-skill collaboration/brainstorming # More specific suffix
  superpowers-agent use-skill test-driven-development    # Matches superpowers:testing/test-driven-development

Examples (explicit paths):
  superpowers-agent use-skill superpowers:collaboration/brainstorming  # Full superpowers skill path
  superpowers-agent use-skill claude:email-assistant                   # Full claude skill path
  superpowers-agent use-skill my-custom-skill                          # Project skill

Smart matching:
  - Type just the skill name or any suffix of the path
  - Priority: .agents/skills/ > .claude/skills/ > ~/.agents/skills/ > ~/.agents/superpowers/skills/
  - If multiple skills match at same priority, you'll see them with descriptions`);return}let o=T(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),console.log("Run: superpowers-agent find-skills");return}let{skillFile:t,sourceType:r,actualSkillPath:s}=o;try{let{content:n,frontmatter:l}=Ye(t),i=te[r].prefix+s,d=Ms(t),a=`# ${l.name||i}`;l.description&&(a+=`
# ${l.description}`),l.whenToUse&&(a+=`
# When to use: ${l.whenToUse}`),a+=`
# Supporting tools and docs are in ${d}
# ============================================

${n}`,console.log(a)}catch(n){console.log(n.message)}};var Vo={bootstrap:Oo,version:To,"check-updates":()=>{Ao().catch(e=>{console.error(e.message),process.exit(1)})},update:()=>{let e=process.argv.includes("--no-reinstall");Ce({skipReinstall:e})},"config-get":fo,"config-set":ho,"setup-skills":Lo,"use-skill":()=>Bo(process.argv[3]),execute:po,"find-skills":G,add:_o,"add-repository":Jo,pull:Ho,dir:mo,path:uo,"get-helpers":go,"install-copilot-prompts":W,"install-copilot-instructions":_,"install-cursor-commands":J,"install-cursor-hooks":B,"install-codex-prompts":V,"install-gemini-commands":K,"install-claude-commands":Y,"install-opencode-commands":z,"install-aliases":We,default:()=>{console.log(`Superpowers for Agents
Usage:
  superpowers-agent bootstrap [--no-update] [--force]               # Run complete bootstrap
  superpowers-agent version                                         # Show current version
  superpowers-agent check-updates                                   # Check for updates
  superpowers-agent update [--no-reinstall]                         # Update to latest version
  superpowers-agent config-get                                      # Show configuration
  superpowers-agent config-set <key> <value>                        # Update configuration
  superpowers-agent setup-skills                                    # Initialize project skills
  superpowers-agent use-skill <skill-name>                          # Load a skill
  superpowers-agent find-skills                                     # List available skills
  superpowers-agent add <url-or-path|@alias> [path] [options]      # Install skills
  superpowers-agent add-repository <git-url> [--as=@alias] [opts]  # Add repository alias
  superpowers-agent pull <url-or-path|@alias> [path] [options]     # Update skills
  superpowers-agent dir <skill-name>                                # Get skill directory
  superpowers-agent path <skill-name>                               # Get skill file path
  superpowers-agent execute <skill-name>                            # Execute a skill
  superpowers-agent get-helpers <skill> <search-term>               # Get helper file path
  superpowers-agent install-copilot-prompts                         # Install GitHub Copilot prompts
  superpowers-agent install-copilot-instructions                    # Install universal instructions
  superpowers-agent install-cursor-commands                         # Install Cursor commands
  superpowers-agent install-cursor-hooks                            # Install Cursor hooks
  superpowers-agent install-codex-prompts                           # Install Codex prompts
  superpowers-agent install-gemini-commands                         # Install Gemini commands
  superpowers-agent install-claude-commands                         # Install Claude commands
  superpowers-agent install-opencode-commands                       # Install OpenCode commands
  superpowers-agent install-aliases                                 # Install universal aliases (superpowers, superpowers-agent)

Documentation: https://github.com/complexthings/superpowers
`)}},Ws=process.argv[2]||"default",_s=Vo[Ws]||Vo.default;try{_s()}catch(e){console.error(`Error: ${e.message}`),process.exit(1)}
