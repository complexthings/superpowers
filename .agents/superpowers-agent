#!/usr/bin/env node
var fe=Object.defineProperty;var Do=Object.getOwnPropertyDescriptor;var Io=Object.getOwnPropertyNames;var Eo=Object.prototype.hasOwnProperty;var Uo=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(o,s)=>(typeof require<"u"?require:o)[s]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var De=(e,o)=>()=>(e&&(o=e(e=0)),o);var Ao=(e,o)=>{for(var s in o)fe(e,s,{get:o[s],enumerable:!0})},Po=(e,o,s,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let t of Io(o))!Eo.call(e,t)&&t!==s&&fe(e,t,{get:()=>o[t],enumerable:!(r=Do(o,t))||r.enumerable});return e};var Ie=e=>Po(fe({},"__esModule",{value:!0}),e);import{homedir as Ee,platform as To}from"os";import{join as k,parse as Fo,dirname as Ue}from"path";import{existsSync as z}from"fs";import{fileURLToPath as vo}from"url";var No,Y,Lo,Oo,i,$=De(()=>{No=vo(import.meta.url),Y=Ue(No),Lo=()=>{let e=Ee();switch(To()){case"darwin":return k(e,"Library","Application Support","Code","User");case"win32":return k(e,"AppData","Roaming","Code","User");case"linux":return k(e,".config","Code","User");default:return k(e,".config","Code","User")}},Oo=()=>{let e=process.cwd(),o=Fo(e).root;for(;e!==o;){if(z(k(e,".agents")))return e;e=Ue(e)}return process.cwd()},i={home:Ee(),vscodeUserDir:Lo(),projectRoot:Oo(),get projectClaudeSkills(){return k(this.projectRoot,".claude","skills")},get projectAgentsSkills(){return k(this.projectRoot,".agents","skills")},get projectSkillsDir(){return k(this.projectRoot,"skills")},get homePersonalSkills(){return k(this.home,".agents","skills")},get bootstrap(){return k(this.projectRoot,".agents","superpowers-bootstrap.md")},get superpowersRepo(){let e=k(Y,"..","..","..","skills");return z(e)&&z(k(Y,"..","..","..",".github","prompts"))?k(Y,"..","..",".."):k(this.home,".agents","superpowers")},get homeSuperpowersSkills(){return k(this.superpowersRepo,"skills")},get isSuperpowersRepo(){let e=k(Y,"..","..","..","skills");return z(e)&&z(k(Y,"..","..","..",".github","prompts"))}}});var Ce={};Ao(Ce,{addRepositoryToConfig:()=>Bo,getDefaultConfig:()=>te,getRepositories:()=>Ho,readConfig:()=>F,readConfigFile:()=>$e,writeConfig:()=>Z,writeConfigFile:()=>We});import{readFileSync as Ge,writeFileSync as Me,existsSync as Se}from"fs";import{join as U}from"path";import{execSync as Vo}from"child_process";var te,F,Z,$e,We,Ho,Bo,v=De(()=>{$();te=()=>({auto_update:!0,last_update_check:null,last_updated_commit:null}),F=()=>{let e=U(i.superpowersRepo,".config.json");try{if(!Se(e))return te();let o=Ge(e,"utf8");return{...te(),...JSON.parse(o)}}catch{return te()}},Z=e=>{let o=U(i.superpowersRepo,".config.json"),r={...F(),...e};try{Me(o,JSON.stringify(r,null,2))}catch(t){console.log(`Warning: couldn't save config: ${t.message}`)}},$e=e=>{let o=e?U(i.home,".agents","config.json"):U(process.cwd(),".agents","config.json");if(!Se(o))return{};try{let s=Ge(o,"utf8");return JSON.parse(s)}catch{return{}}},We=(e,o)=>{let s=o?U(i.home,".agents"):U(process.cwd(),".agents"),r=U(s,"config.json");try{return Se(s)||Vo(`mkdir -p "${s}"`,{stdio:"pipe"}),Me(r,JSON.stringify(e,null,2),"utf8"),!0}catch(t){throw new Error(`Failed to write config: ${t.message}`)}},Ho=(e=!1)=>$e(e).repositories||{},Bo=(e,o,s)=>{let r=$e(s);r.repositories||(r.repositories={}),r.repositories[e]=o,We(r,s)}});$();import{relative as Be,dirname as Ke,join as Zo}from"path";import{existsSync as xe}from"fs";import{readFileSync as Ae}from"fs";var q=e=>{try{let s=Ae(e,"utf8").split(`
`),r={name:"",description:"",whenToUse:""},t=!1;for(let n of s){if(n.trim()==="---"){if(t)break;t=!0;continue}if(t){let l=n.match(/^(\w+):\s*(.*)$/);if(l){let[,a,p]=l,c={name:"name",description:"description",when_to_use:"whenToUse"};c[a]&&(r[c[a]]=p.trim())}}}return r}catch{return{name:"",description:"",whenToUse:""}}},Pe=e=>{try{let o=Ae(e,"utf8"),s=q(e),r=o.split(`
`),t=!1,n=!1,l=[];for(let a of r){if(a.trim()==="---"){if(t){n=!0;continue}t=!0;continue}(n||!t)&&l.push(a)}return{content:l.join(`
`).trim(),frontmatter:s}}catch(o){throw new Error(`Error reading skill file: ${o.message}`)}};$();import{existsSync as ke,readdirSync as ve,statSync as Ne}from"fs";import{join as ye,relative as Os}from"path";import{readFileSync as Go,existsSync as Mo}from"fs";import{join as Te}from"path";var Q=e=>{let o=Te(e,"skill.json");if(!Mo(o))return null;try{let s=Go(o,"utf8");return JSON.parse(s)}catch{return null}};var he=e=>e.startsWith("superpowers:")?{type:"superpowers",path:e.substring(12).replace(/^skills\//,"")}:e.startsWith("claude:")?{type:"claude",path:e.substring(7).replace(/^skills\//,"")}:{type:null,path:e.replace(/^skills\//,"")},Fe=(e,o)=>{let s=Q(e);if(!s||!s.helpers||!Array.isArray(s.helpers))return null;let r=s.helpers,t=o.toLowerCase(),n=null,l=0;for(let a of r){let p=a.toLowerCase();if(p===t){n=a;break}if(p.includes(t)){let g=t.length/p.length;g>l&&(l=g,n=a)}let c=a.split("/").pop().split(".")[0].toLowerCase();if(t.includes(c)){let g=c.length/t.length;g>l&&(l=g,n=a)}}return n?Te(e,n):null},X={claude:{dir:"projectClaudeSkills",prefix:"claude:"},project:{dir:"projectAgentsSkills",prefix:""},personal:{dir:"homePersonalSkills",prefix:""},superpowers:{dir:"homeSuperpowersSkills",prefix:"superpowers:"}};var se=(e,o,s=null)=>{let r=[];if(!ke(e))return r;let t=(n,l)=>{if(!(s!==null&&l>s))try{let a=ve(n,{withFileTypes:!0});for(let p of a){if(p.name==="node_modules"||p.name===".git"||p.name.startsWith("."))continue;let c=ye(n,p.name),g=p.isDirectory();if(p.isSymbolicLink())try{g=Ne(c).isDirectory()}catch{continue}if(!g)continue;let d=ye(c,"SKILL.md");ke(d)&&r.push(c),(s===null||l<s)&&t(c,l+1)}}catch{}};return t(e,0),r};var Le=(e,o)=>{if(!ke(e))return[];let s=[],r=o.toLowerCase().replace(/\\/g,"/"),t=(n,l="")=>{try{let a=ve(n,{withFileTypes:!0});for(let p of a){let c=ye(n,p.name),g=l?`${l}/${p.name}`:p.name,d=p.isDirectory();if(p.isSymbolicLink())try{d=Ne(c).isDirectory()}catch{continue}if(!(d&&(p.name==="node_modules"||p.name===".git"||p.name.startsWith(".")))){if(d)t(c,g);else if(p.name==="SKILL.md"){let m=l.toLowerCase().replace(/\\/g,"/");(m===r||m.endsWith("/"+r)||m.endsWith(r))&&s.push({file:c,path:l})}}}}catch{}};return t(e),s},Oe=(e,o,s)=>{let r={project:"project skills (.agents/skills/)",claude:"claude skills (.claude/skills/)",personal:"personal skills (~/.agents/skills/)",superpowers:"superpowers skills (~/.agents/superpowers/skills/)"}[s];console.log(`Error: Multiple skills match "${e}" in ${r}:
`);for(let t of o){let l=X[s].prefix+t.path;try{let a=q(t.file),p=a.description||a.whenToUse||"(no description)";console.log(`  ${l}`),console.log(`    ${p}
`)}catch{console.log(`  ${l}`),console.log(`    (unable to read description)
`)}}console.log("Please be more specific. Examples:");for(let t of o.slice(0,2)){let n=X[s].prefix;console.log(`  superpowers-agent execute ${n}${t.path}`)}};$();import{existsSync as we}from"fs";import{join as Wo,relative as _o}from"path";var Jo=e=>{let{type:o,path:s}=he(e),r={superpowers:i.homeSuperpowersSkills,claude:i.projectClaudeSkills,project:i.projectAgentsSkills,personal:i.homePersonalSkills},t;o?t=[{type:o,dir:r[o]}]:i.isSuperpowersRepo&&we(i.projectSkillsDir)?t=[{type:"project",dir:i.projectSkillsDir},{type:"project",dir:i.projectAgentsSkills},{type:"claude",dir:i.projectClaudeSkills},{type:"personal",dir:i.homePersonalSkills},{type:"superpowers",dir:i.homeSuperpowersSkills}]:t=[{type:"project",dir:i.projectAgentsSkills},{type:"claude",dir:i.projectClaudeSkills},{type:"personal",dir:i.homePersonalSkills},{type:"superpowers",dir:i.homeSuperpowersSkills}];for(let{type:n,dir:l}of t){let a=Le(l,s);if(a.length===1)return{skillFile:a[0].file,sourceType:n,actualSkillPath:a[0].path};a.length>1&&Oe(s,a,n)}return null},E=e=>{let o=Jo(e);if(o)return o;let{type:s,path:r}=he(e),t;s?t=[{type:s,dir:{superpowers:i.homeSuperpowersSkills,claude:i.projectClaudeSkills,project:i.projectAgentsSkills,personal:i.homePersonalSkills}[s]}]:i.isSuperpowersRepo&&we(i.projectSkillsDir)?t=[{type:"project",dir:i.projectSkillsDir},{type:"project",dir:i.projectAgentsSkills},{type:"claude",dir:i.projectClaudeSkills},{type:"personal",dir:i.homePersonalSkills},{type:"superpowers",dir:i.homeSuperpowersSkills}]:t=[{type:"project",dir:i.projectAgentsSkills},{type:"claude",dir:i.projectClaudeSkills},{type:"personal",dir:i.homePersonalSkills},{type:"superpowers",dir:i.homeSuperpowersSkills}];for(let{type:n,dir:l}of t){if(!we(l))continue;let a=se(l,n,null);for(let p of a){let c=Q(p);if(c&&c.aliases&&Array.isArray(c.aliases)){let g=r.toLowerCase();for(let d of c.aliases)if(d.toLowerCase()===g){let m=Wo(p,"SKILL.md"),u=_o(l,p);return{skillFile:m,sourceType:n,actualSkillPath:u}}}}}return null};v();import{readFileSync as Ko}from"fs";import{join as _e,dirname as Yo}from"path";import{fileURLToPath as zo}from"url";import{existsSync as qo}from"fs";import{execSync as Qo}from"child_process";var Xo=zo(import.meta.url),Je=Yo(Xo),I=()=>{try{let e=_e(Je,"package.json");return qo(e)||(e=_e(Je,"..","..","package.json")),JSON.parse(Ko(e,"utf8")).version||"5.4.0"}catch{return"5.4.0"}},D=()=>{let e=I();console.log(`^^SAV:${e}^^`)},Ve=async()=>{try{let o=Qo('curl -sS "https://raw.githubusercontent.com/complexthings/superpowers/main/.agents/package.json"',{encoding:"utf8",timeout:1e4}),s=JSON.parse(o);return s.version?s.version:I()}catch(e){throw new Error(`Failed to fetch remote version: ${e.message}`)}},He=(e,o)=>{let s=e.split(".").map(Number),r=o.split(".").map(Number);for(let t=0;t<3;t++){let n=s[t]||0,l=r[t]||0;if(n>l)return!0;if(n<l)return!1}return!1};var es={project:{dir:"projectAgentsSkills",prefix:""},claude:{dir:"projectClaudeSkills",prefix:"claude:"},personal:{dir:"homePersonalSkills",prefix:""},superpowers:{dir:"homeSuperpowersSkills",prefix:"superpowers:"}},os=(e,o)=>{let s=Zo(e,"SKILL.md"),{dir:r,prefix:t}=es[o],n=Be(i[r],e).replace(/\\/g,"/");console.log(`${t}${n}`);let{description:l,whenToUse:a}=q(s);l&&console.log(`  ${l}`),a&&console.log(`  When to use: ${a}`),console.log("")},N=()=>{D();let e=new Set,o=[{type:"project",dir:i.projectAgentsSkills,maxDepth:null},{type:"claude",dir:i.projectClaudeSkills,maxDepth:null},{type:"personal",dir:i.homePersonalSkills,maxDepth:null},{type:"superpowers",dir:i.homeSuperpowersSkills,maxDepth:null}];for(let{type:s,dir:r,maxDepth:t}of o){let n=se(r,s,t);for(let l of n){let a=Be(r,l);e.has(a)||(e.add(a),os(l,s))}}console.log(`Usage:
  superpowers-agent execute <skill-name> # Load a specific skill`)},Ye=()=>{D();let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent execute <skill-name-or-alias>

Examples:
  superpowers-agent execute brainstorming
  superpowers-agent execute superpowers:collaboration/brainstorming
  superpowers-agent execute aem/block-collection-and-party
  superpowers-agent execute block-collection  # Using alias

Description:
  Instructs the agent to execute the specified skill.
  Supports skill aliases defined in skill.json files.`);return}let o=E(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),N();return}let{skillFile:s,sourceType:r}=o,t=process.cwd(),n=s.startsWith(t),l=xe(i.projectAgentsSkills)||xe(i.projectClaudeSkills);console.log(n?`Open this file with your Read Tool: ${s}

<IMPORTANT>
USE YOUR Read Tool to process this file. DO NOT use \`cat\` or print commands.
</IMPORTANT>`:l&&r!=="project"?`Open this file with your Read Tool: ${s}

<IMPORTANT>
1. Try using your Read Tool first
2. If your Read tool fails (file outside workspace), use: cat "${s}"
3. Consider using workspace-local skills for better tool compatibility
   Run: superpowers-agent setup-skills
</IMPORTANT>`:`Open this file with your Read Tool: ${s}

<IMPORTANT>
1. Try using your Read Tool first
2. If your Read tool fails (file outside workspace), use: cat "${s}"
3. NEVER skip loading the skill content
</IMPORTANT>`)},ze=()=>{let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent path <skill-name-or-alias>

Examples:
  superpowers-agent path brainstorming
  superpowers-agent path superpowers:collaboration/brainstorming
  superpowers-agent path aem/block-collection-and-party
  superpowers-agent path block-collection  # Using alias

Description:
  Outputs the file system path of the specified SKILL.md file.
  Supports skill aliases defined in skill.json files.`);return}let o=E(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),N();return}let{skillFile:s}=o;console.log(s)},qe=()=>{let e=process.argv[3];if(!e){console.log(`Usage: superpowers-agent dir <skill-name>

Examples:
  superpowers-agent dir brainstorming
  superpowers-agent dir aem/block-collection-and-party
  superpowers-agent dir block-collection  # Using alias
  superpowers-agent dir superpowers:testing/test-driven-development

Description:
  Returns the directory path where the specified skill is located.
  Supports skill aliases defined in skill.json files.`);return}let o=E(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),N();return}let{skillFile:s}=o,r=Ke(s);console.log(r)},Qe=()=>{D();let e=process.argv[3],o=process.argv[4];if(!e||!o){console.log(`Usage: superpowers-agent get-helpers <skill-name> <helper-search-term>

Examples:
  superpowers-agent get-helpers block-collection search-block
  superpowers-agent get-helpers aem/block-collection-and-party get-block-structure
  superpowers-agent get-helpers superpowers:testing/test-driven-development example

Description:
  Searches for helper files within a skill's skill.json configuration.
  Returns the full path to the best matching helper file.
  
  The command uses the skill's aliases if available, so you can use
  short names like "block-collection" instead of the full path.`);return}let s=E(e);if(!s){console.log(`Error: Skill not found: ${e}

Available skills:`),N();return}let{skillFile:r}=s,t=Ke(r),n=Q(t);if(!n){console.log(`Error: No skill.json found for skill: ${e}
  Location: ${t}`);return}if(!n.helpers||!Array.isArray(n.helpers)||n.helpers.length===0){console.log(`Error: No helpers defined in skill.json for skill: ${e}
  Location: ${t}`);return}let l=Fe(t,o);if(!l){console.log(`Error: No helper found matching "${o}" in skill: ${e}`),console.log(`
Available helpers:`);for(let a of n.helpers)console.log(`  - ${a}`);return}if(!xe(l)){console.log(`Error: Helper file not found: ${l}
  Defined in skill.json but missing from filesystem`);return}console.log(l)},Xe=()=>{let e=F();console.log("Current configuration:"),console.log(JSON.stringify(e,null,2))},Ze=()=>{let e=process.argv[3],o=process.argv[4];if(!e||o===void 0){console.log(`Usage: .agents/superpowers-agent config-set <key> <value>

Available keys:
  auto_update (true/false) - Enable/disable automatic updates during bootstrap

Examples:
  .agents/superpowers-agent config-set auto_update false
  .agents/superpowers-agent config-set auto_update true`);return}let s=o;o==="true"?s=!0:o==="false"&&(s=!1);let r={};r[e]=s,Z(r),console.log(`\u2713 Set ${e} = ${s}`)};$();v();import{execSync as cs}from"child_process";$();import{execSync as A}from"child_process";var ss=()=>{try{return A("git status --porcelain --untracked-files=no",{cwd:i.superpowersRepo,encoding:"utf8",stdio:"pipe",timeout:3e3}).trim().length===0}catch{return!1}},ee=()=>{try{return A("git rev-parse --abbrev-ref HEAD",{cwd:i.superpowersRepo,encoding:"utf8",stdio:"pipe",timeout:3e3}).trim()==="main"}catch{return!1}},re=()=>{try{A("git fetch origin",{cwd:i.superpowersRepo,timeout:5e3,stdio:"pipe"});let e=!ss(),o=A("git rev-parse HEAD",{cwd:i.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim(),s=A("git rev-parse origin/main",{cwd:i.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim();if(!(o!==s))return{hasUpdates:!1,hasLocalChanges:e,currentCommit:o,latestCommit:s,commitsBehind:0,changedFiles:[]};let t=parseInt(A("git rev-list --count HEAD..origin/main",{cwd:i.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim(),10),l=A("git diff --name-only HEAD origin/main",{cwd:i.superpowersRepo,encoding:"utf8",stdio:"pipe"}).trim().split(`
`).filter(a=>a.length>0);return{hasUpdates:!0,hasLocalChanges:e,currentCommit:o,latestCommit:s,commitsBehind:t,changedFiles:l}}catch{return{hasUpdates:!1,hasLocalChanges:!1,currentCommit:"",latestCommit:"",commitsBehind:0,changedFiles:[],error:!0}}},eo=e=>{let o={".github/prompts/":"copilot-prompts",".github/copilot-instructions.md":"copilot-instructions",".cursor/commands/":"cursor-commands","hooks/cursor/":"cursor-hooks",".codex/prompts/":"codex-prompts",".gemini/commands/":"gemini-commands","commands/":"claude-commands",".opencode/command/":"opencode-commands"},s=new Set;for(let r of e)for(let[t,n]of Object.entries(o))r.startsWith(t)&&s.add(n);return Array.from(s)};$();import{existsSync as ne,readdirSync as ts}from"fs";import{join as L,dirname as rs}from"path";import{execSync as le}from"child_process";var O=()=>{let e=L(i.superpowersRepo,".github","prompts"),o=L(i.vscodeUserDir,"prompts");if(!ne(e)){console.log("\u26A0\uFE0F  No Copilot prompts to install (source directory not found).");return}try{ne(o)||le(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(t){console.log(`Error creating prompts directory: ${t.message}`);return}let s;try{s=ts(e).filter(t=>t.endsWith(".prompt.md"))}catch(t){console.log(`Error reading prompts directory: ${t.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No prompt files found to install.");return}console.log("Installing GitHub Copilot prompts...");let r=0;for(let t of s)try{let n=L(e,t),l=L(o,t);le(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${t}`),r++}catch(n){console.log(`  \u2717 Failed to install ${t}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} prompt(s) to ${o}
  Use slash commands in GitHub Copilot:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)},G=()=>{let e=L(i.superpowersRepo,".github","copilot-instructions.md"),o=L(i.home,".github","copilot-instructions.md");if(!ne(e)){console.log("\u26A0\uFE0F  No Copilot instructions to install (source file not found).");return}let s=rs(o);try{ne(s)||le(`mkdir -p "${s}"`,{stdio:"pipe"})}catch(r){console.log(`Error creating .github directory: ${r.message}`);return}try{le(`cp "${e}" "${o}"`,{stdio:"pipe"}),console.log(`\u2713 Installed GitHub Copilot universal instructions
  Location: ${o}
  GitHub Copilot will now use Superpowers skills universally in all workspaces`)}catch(r){console.log(`\u2717 Failed to install instructions: ${r.message}`)}};$();import{existsSync as ie,readdirSync as oo}from"fs";import{join as R}from"path";import{execSync as M}from"child_process";var W=()=>{let e=R(i.superpowersRepo,".cursor","commands"),o=R(i.home,".cursor","commands");if(!ie(e)){console.log("\u26A0\uFE0F  No Cursor commands to install (source directory not found).");return}try{ie(o)||M(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(t){console.log(`Error creating Cursor commands directory: ${t.message}`);return}let s;try{s=oo(e).filter(t=>t.endsWith(".md"))}catch(t){console.log(`Error reading Cursor commands directory: ${t.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Cursor commands...");let r=0;for(let t of s)try{let n=R(e,t),l=R(o,t);M(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${t}`),r++}catch(n){console.log(`  \u2717 Failed to install ${t}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in Cursor:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)},_=()=>{let e=R(i.superpowersRepo,"hooks","cursor"),o=R(i.home,".cursor","hooks"),s=R(e,"hooks.json"),r=R(i.home,".cursor","hooks.json");if(!ie(e)){console.log("\u26A0\uFE0F  No Cursor hooks to install (source directory not found).");return}try{ie(o)||M(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(l){console.log(`Error creating Cursor hooks directory: ${l.message}`);return}try{M(`cp "${s}" "${r}"`,{stdio:"pipe"}),console.log("  \u2713 Installed hooks.json")}catch(l){console.log(`  \u2717 Failed to install hooks.json: ${l.message}`);return}let t;try{t=oo(e).filter(l=>l.endsWith(".sh"))}catch(l){console.log(`Error reading hooks directory: ${l.message}`);return}if(t.length===0){console.log("\u26A0\uFE0F  No hook scripts found to install.");return}console.log("Installing Cursor hooks...");let n=0;for(let l of t)try{let a=R(e,l),p=R(o,l);M(`cp "${a}" "${p}"`,{stdio:"pipe"}),M(`chmod +x "${p}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${l}`),n++}catch(a){console.log(`  \u2717 Failed to install ${l}: ${a.message}`)}n>0&&console.log(`
\u2713 Installed ${n} hook(s) to ${o}
  Cursor will now check for skills before each prompt submission
  Restart Cursor for hooks to take effect`)};$();import{existsSync as so,readdirSync as ns}from"fs";import{join as ae}from"path";import{execSync as to}from"child_process";var J=()=>{let e=ae(i.superpowersRepo,".codex","prompts"),o=ae(i.home,".codex","prompts");if(!so(e)){console.log("\u26A0\uFE0F  No Codex prompts to install (source directory not found).");return}try{so(o)||to(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(t){console.log(`Error creating Codex prompts directory: ${t.message}`);return}let s;try{s=ns(e).filter(t=>t.endsWith(".md"))}catch(t){console.log(`Error reading Codex prompts directory: ${t.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No prompt files found to install.");return}console.log("Installing OpenAI Codex prompts...");let r=0;for(let t of s)try{let n=ae(e,t),l=ae(o,t);to(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${t}`),r++}catch(n){console.log(`  \u2717 Failed to install ${t}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} prompt(s) to ${o}
  Use slash commands in OpenAI Codex:
    /prompts:brainstorm - Refine ideas into designs
    /prompts:write-skill - Create new skills with TDD
    /prompts:skills - Discover available skills
    /prompts:use-skill - Load and apply a specific skill
  Note: Restart Codex or open a new session to reload prompts`)};$();import{existsSync as ro,readdirSync as ls}from"fs";import{join as ce}from"path";import{execSync as no}from"child_process";var V=()=>{let e=ce(i.superpowersRepo,".gemini","commands"),o=ce(i.home,".gemini","commands");if(!ro(e)){console.log("\u26A0\uFE0F  No Gemini commands to install (source directory not found).");return}try{ro(o)||no(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(t){console.log(`Error creating Gemini commands directory: ${t.message}`);return}let s;try{s=ls(e).filter(t=>t.endsWith(".toml"))}catch(t){console.log(`Error reading Gemini commands directory: ${t.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Gemini commands...");let r=0;for(let t of s)try{let n=ce(e,t),l=ce(o,t);no(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${t}`),r++}catch(n){console.log(`  \u2717 Failed to install ${t}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in Gemini:
    /brainstorm-with-superpowers - Refine ideas into designs
    /write-a-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};$();import{existsSync as lo,readdirSync as is}from"fs";import{join as pe}from"path";import{execSync as io}from"child_process";var H=()=>{let e=pe(i.superpowersRepo,"commands"),o=pe(i.home,".claude","commands");if(!lo(e)){console.log("\u26A0\uFE0F  No Claude commands to install (source directory not found).");return}try{lo(o)||io(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(t){console.log(`Error creating Claude commands directory: ${t.message}`);return}let s;try{s=is(e).filter(t=>t.endsWith(".md"))}catch(t){console.log(`Error reading Claude commands directory: ${t.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing Claude Code commands...");let r=0;for(let t of s)try{let n=pe(e,t),l=pe(o,t);io(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${t}`),r++}catch(n){console.log(`  \u2717 Failed to install ${t}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in Claude Code:
    /brainstorm - Refine ideas into designs
    /execute-plan - Execute plans in batches
    /write-plan - Create implementation plans
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};$();import{existsSync as ao,readdirSync as as}from"fs";import{join as de}from"path";import{execSync as co}from"child_process";var B=()=>{let e=de(i.superpowersRepo,".opencode","command"),o=de(i.home,".config","opencode","command");if(!ao(e)){console.log("\u26A0\uFE0F  No opencode commands to install (source directory not found).");return}try{ao(o)||co(`mkdir -p "${o}"`,{stdio:"pipe"})}catch(t){console.log(`Error creating opencode commands directory: ${t.message}`);return}let s;try{s=as(e).filter(t=>t.endsWith(".md"))}catch(t){console.log(`Error reading opencode commands directory: ${t.message}`);return}if(s.length===0){console.log("\u26A0\uFE0F  No command files found to install.");return}console.log("Installing opencode commands...");let r=0;for(let t of s)try{let n=de(e,t),l=de(o,t);co(`cp "${n}" "${l}"`,{stdio:"pipe"}),console.log(`  \u2713 Installed ${t}`),r++}catch(n){console.log(`  \u2717 Failed to install ${t}: ${n.message}`)}r>0&&console.log(`
\u2713 Installed ${r} command(s) to ${o}
  Use slash commands in opencode:
    /brainstorm - Refine ideas into designs
    /execute-plan - Execute plans in batches
    /write-plan - Create implementation plans
    /write-skill - Create new skills with TDD
    /skills - Discover available skills
    /use-skill - Load and apply a specific skill`)};var ps=e=>{let s={"copilot-prompts":O,"copilot-instructions":G,"cursor-commands":W,"cursor-hooks":_,"codex-prompts":J,"gemini-commands":V,"claude-commands":H,"opencode-commands":B}[e];if(s)try{return s(),{success:!0,integration:e}}catch(r){return{success:!1,integration:e,error:r.message}}return{success:!1,integration:e,error:"Unknown integration"}},ds=()=>{console.log("Installing aliases...")},ue=(e={})=>{let o=e.skipReinstall||!1;console.log(`# Checking for Superpowers updates...
`);let s=re();if(s.error){console.log("\u26A0\uFE0F  Could not check for updates (network issue)");return}if(!s.hasUpdates){console.log("\u2713 Already up to date");return}if(s.hasLocalChanges){console.log(`\u26A0\uFE0F  Cannot auto-update: local changes detected
   Commit or stash your changes first, then run update again
   Or manually update: cd ${i.superpowersRepo} && git pull`);return}if(!ee()){console.log(`\u26A0\uFE0F  Not on main branch, skipping auto-update
   Switch to main branch first: cd ${i.superpowersRepo} && git checkout main`);return}console.log(`\u{1F4E6} Updating from ${s.currentCommit.substring(0,7)} to ${s.latestCommit.substring(0,7)}
   (${s.commitsBehind} new commit${s.commitsBehind>1?"s":""})
`);try{cs("git pull origin main",{cwd:i.superpowersRepo,stdio:"pipe",timeout:1e4}),console.log("\u2713 Updated superpowers repository")}catch(l){console.log(`\u2717 Git pull failed: ${l.message}
   Please resolve manually and try again`);return}if(console.log(""),Z({last_updated_commit:s.latestCommit,last_update_check:new Date().toISOString()}),o){console.log(`\u2139\uFE0F  Skipping integration reinstall (--no-reinstall flag)

\u2713 Update complete!`);return}let r=eo(s.changedFiles);if(r.length===0){console.log(`\u2139\uFE0F  No integration files changed, skipping reinstalls

\u2713 Update complete!`);return}console.log(`\u{1F504} Reinstalling updated integrations:
`);let t=[];for(let l of r){let a=ps(l);t.push(a),a.success?console.log(`  \u2713 ${l}`):console.log(`  \u2717 ${l} (${a.error})`)}console.log(""),console.log(`
---
`),ds();let n=t.filter(l=>!l.success);if(n.length>0){console.log("\u26A0\uFE0F  Update completed with errors:");for(let l of n){console.log(`  - ${l.integration} failed to install`);let a=`install-${l.integration}`;console.log(`    Run manually: superpowers-agent ${a}`)}}else console.log("\u2713 Update complete!")},po=async()=>{D();let e=I();console.log(`Current version: ${e}`);try{let o=await Ve();console.log(`Latest version: ${o}`),He(o,e)?(console.log("Update available: Yes"),process.exit(1)):(console.log("You are up to date"),process.exit(0))}catch(o){console.log(`Error checking for updates: ${o.message}`),process.exit(1)}},uo=()=>{let e=I();console.log(e)};$();v();import{existsSync as C,readFileSync as be,writeFileSync as go}from"fs";import{join as w,dirname as ms,parse as fo}from"path";import{execSync as K}from"child_process";import{platform as gs}from"os";import{execSync as us}from"child_process";var oe=e=>{try{return us(`which ${e}`,{stdio:"pipe",timeout:2e3}),!0}catch{return!1}};var f={opencode:{check:()=>oe("opencode"),cli:!0,name:"OpenCode",installUrl:"https://opencode.ai/docs/installation",bootstrapCommand:"install-opencode-commands"},claude:{check:()=>oe("claude"),cli:!0,name:"Claude Code",installUrl:"https://code.claude.com/docs/en/installation",bootstrapCommand:"install-claude-commands"},gemini:{check:()=>oe("gemini"),cli:!0,name:"Gemini",installUrl:"https://cloud.google.com/gemini/docs/cli/install",bootstrapCommand:"install-gemini-commands"},codex:{check:()=>oe("codex"),cli:!0,name:"Codex",installUrl:"https://developers.openai.com/codex/docs/installation",bootstrapCommand:"install-codex-prompts"},cursor:{check:()=>!0,cli:!1,name:"Cursor",bootstrapCommand:"install-cursor-commands"},copilot:{check:()=>!0,cli:!1,name:"GitHub Copilot",bootstrapCommand:"install-copilot-prompts"}},mo=()=>{let e=[];return f.copilot.check()&&e.push("github-copilot"),f.cursor.check()&&e.push("cursor"),f.claude.check()&&e.push("claude-code"),f.opencode.check()&&e.push("opencode"),f.gemini.check()&&e.push("gemini"),f.codex.check()&&e.push("codex"),e};var fs=e=>{let o={"github-copilot":"GitHub Copilot",cursor:"Cursor","claude-code":"Claude Code",opencode:"OpenCode",gemini:"Gemini",codex:"Codex"};return e.map(r=>`**Tool Mapping for ${o[r]}:**`).join(`
`)},ho=(e,o,s,r=!0)=>{let t=C(e);if(!t&&!r)return{updated:!1,created:!1,skipped:!0};let n=fs(s),l=o.replace(/\{\{TOOL_MAPPINGS\}\}/g,n),a=new Date().toISOString().split("T")[0];l=l.replace(/\{\{DATE\}\}/g,a),l=l.replace(/\{\{SUPERPOWERS_PATH\}\}/g,i.superpowersRepo);let p=`<!-- SUPERPOWERS_SKILLS_START -->
${l}
<!-- SUPERPOWERS_SKILLS_END -->`;if(t){let c=new Date().toISOString().split("T")[0],g=`${e}.backup-${c}`;try{K(`cp "${e}" "${g}"`,{stdio:"pipe"})}catch(h){return{updated:!1,error:!0,message:`Failed to backup: ${h.message}`}}let d;try{d=be(e,"utf8")}catch(h){return{updated:!1,error:!0,message:`Failed to read: ${h.message}`}}let m="<!-- SUPERPOWERS_SKILLS_START -->",u="<!-- SUPERPOWERS_SKILLS_END -->",y;if(d.includes(m)&&d.includes(u)){let h=new RegExp(`${m}[\\s\\S]*?${u}`,"g");y=d.replace(h,p)}else{let h=d.match(/^#\s+.+$/m);if(h){let j=d.indexOf(`
`,h.index)+1;y=d.slice(0,j)+`
`+p+`
`+d.slice(j)}else y=p+`

`+d}try{return go(e,y,"utf8"),{updated:!0,created:!1,backup:g}}catch(h){return{updated:!1,error:!0,message:`Failed to write: ${h.message}`}}}else try{let c=ms(e);C(c)||K(`mkdir -p "${c}"`,{stdio:"pipe"});let m=`# ${fo(e).base.toUpperCase()}

`+p;return go(e,m,"utf8"),{updated:!1,created:!0}}catch(c){return{updated:!1,created:!1,error:!0,message:`Failed to create: ${c.message}`}}},hs=()=>{console.log("Installing Unix aliases...");let e=w(i.superpowersRepo,".agents","superpowers-agent");C(e)?console.log(`\u2713 Alias available at: ${e}`):console.log("\u26A0\uFE0F  superpowers-agent executable not found")},ks=()=>{console.log("Installing Windows aliases..."),console.log("\u2713 Windows alias installation (implementation pending)")},ys=()=>{let e=gs();return console.log(`## Installing Universal Aliases
`),e==="win32"?ks():hs()},ko=()=>{D(),console.log(`# Setting up Superpowers skills for this project
`);let e=process.cwd(),o=w(e,".agents"),s=w(o,"skills"),r=w(e,"AGENTS.md"),t=w(o,"AGENTS.md"),n=C(r)?r:t,l=w(i.superpowersRepo,".agents","templates","AGENTS.md.template");if(!C(l)){console.log(`\u2717 Error: AGENTS.md template not found
  Expected at: ${l}
  Please update your Superpowers installation`);return}if(C(o))console.log("\u2713 .agents/ directory exists");else try{K(`mkdir -p "${o}"`,{stdio:"pipe"}),console.log("\u2713 Created .agents/ directory")}catch(b){console.log(`\u2717 Failed to create .agents/ directory: ${b.message}`);return}if(C(s))console.log("\u2713 .agents/skills/ directory exists");else try{K(`mkdir -p "${s}"`,{stdio:"pipe"}),K(`touch "${w(s,".gitkeep")}"`,{stdio:"pipe"}),console.log("\u2713 Created .agents/skills/ directory")}catch(b){console.log(`\u2717 Failed to create skills directory: ${b.message}`);return}let a=C(n);if(a){let b=new Date().toISOString().split("T")[0],Re=`${n}.backup-${b}`;try{K(`cp "${n}" "${Re}"`,{stdio:"pipe"}),console.log(`\u2713 Backed up existing AGENTS.md to ${fo(Re).base}`)}catch(Ro){console.log(`\u2717 Failed to backup AGENTS.md: ${Ro.message}`);return}}let p;try{p=be(l,"utf8")}catch(b){console.log(`\u2717 Failed to read template: ${b.message}`);return}let c=I();p=p.replace(/\{\{VERSION\}\}/g,c);let g=[],d=w(e,".github","copilot-instructions.md"),m=w(i.home,".github","copilot-instructions.md");(C(d)||C(m)||f.copilot.check())&&g.push("github-copilot");let u=w(e,"CLAUDE.md"),y=w(o,"CLAUDE.md");(C(u)||C(y)||f.claude.check())&&g.push("claude-code");let h=w(e,"GEMINI.md"),j=w(o,"GEMINI.md");(C(h)||C(j)||f.gemini.check())&&g.push("gemini"),f.cursor.check()&&g.push("cursor"),f.opencode.check()&&g.push("opencode"),f.codex.check()&&g.push("codex"),console.log(`
Detected platforms for project: ${g.join(", ")||"none"}
`);let T=g.filter(b=>["github-copilot","cursor","opencode","codex"].includes(b)),ge=ho(n,p,T,!a);ge.created?console.log(`\u2713 Created AGENTS.md with platform tool mappings (${n===r?"root":".agents/"})`):ge.updated?console.log(`\u2713 Updated AGENTS.md with platform tool mappings (${n===r?"root":".agents/"})`):ge.error&&console.log("\u26A0\uFE0F  Failed to update AGENTS.md"),console.log(`
# Setup complete!

Your project now has:
  - .agents/ directory structure
  - AGENTS.md with universal skills instructions
  - .agents/skills/ ready for project-specific skills
`)},yo=()=>{if(D(),console.log(`# Superpowers Bootstrap for Agents
# ==================================
`),!process.argv.includes("--no-update")){let p=F(),c=re();c.error?console.log(`## Update Check

\u26A0\uFE0F  Could not check for updates (network issue)

---
`):c.hasUpdates&&(p.auto_update&&!c.hasLocalChanges&&ee()?(console.log(`## Auto-Update
`),ue(),console.log(`
---
`)):(console.log(`## Update Available
`),c.hasLocalChanges?console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    Cannot auto-update: local changes detected\n    To update, commit/stash changes then run: `superpowers-agent update`"):ee()?console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    To update, run: `superpowers-agent update`\n    Or enable auto-update: `superpowers-agent config-set auto_update true`"):console.log("\u26A0\uFE0F  Your superpowers installation is behind the latest version.\n    Cannot auto-update: not on main branch\n    To update, switch to main then run: `superpowers-agent update`"),console.log(`
---
`)))}ys(),console.log(`---
`),console.log(`## GitHub Copilot Integration
`),O(),console.log(""),G(),console.log(`
---
`),console.log(`## Cursor Integration
`),W(),console.log(""),_(),console.log(`
---
`),console.log(`## OpenAI Codex Integration
`),f.codex.check()?J():console.log(`\u26A0\uFE0F  Skipped (${f.codex.name} CLI not detected)
\u{1F4A1} To enable Codex integration:
   1. Install Codex: ${f.codex.installUrl}
   2. Run: superpowers-agent ${f.codex.bootstrapCommand}`),console.log(`
---
`),console.log(`## Gemini Integration
`),f.gemini.check()?V():console.log(`\u26A0\uFE0F  Skipped (${f.gemini.name} CLI not detected)
\u{1F4A1} To enable Gemini integration:
   1. Install Gemini: ${f.gemini.installUrl}
   2. Run: superpowers-agent ${f.gemini.bootstrapCommand}`),console.log(`
---
`),console.log(`## Claude Code Integration
`),f.claude.check()?H():console.log(`\u26A0\uFE0F  Skipped (${f.claude.name} CLI not detected)
\u{1F4A1} To enable Claude Code integration:
   1. Install Claude Code: ${f.claude.installUrl}
   2. Run: superpowers-agent ${f.claude.bootstrapCommand}`),console.log(`
---
`),console.log(`## OpenCode Integration
`),f.opencode.check()?B():console.log(`\u26A0\uFE0F  Skipped (${f.opencode.name} CLI not detected)
\u{1F4A1} To enable OpenCode integration:
   1. Install OpenCode: ${f.opencode.installUrl}
   2. Run: superpowers-agent ${f.opencode.bootstrapCommand}`),console.log(`
---
`),console.log(`## Generating Platform-Specific Files
`);let n=mo();console.log(`Detected platforms: ${n.join(", ")||"none"}
`);let l=w(i.superpowersRepo,".agents","templates","AGENTS.md.template"),a="";try{a=be(l,"utf8")}catch(p){console.log(`\u26A0\uFE0F  Could not read AGENTS.md template: ${p.message}
`)}if(a){let p=I();a=a.replace(/\{\{VERSION\}\}/g,p);let c=w(i.home,".agents","AGENTS.md"),g=ho(c,a,n,!0);g.created?console.log(`\u2713 Created ${c}`):g.updated&&console.log(`\u2713 Updated ${c}`)}console.log(`
---
`),console.log(`# Bootstrap Complete!
`),console.log("\u2713 All integrations installed"),console.log(`\u2713 Skills system ready
`),console.log("Next steps:"),console.log("  - Run `superpowers-agent find-skills` to see available skills"),console.log("  - Run `superpowers-agent setup-skills` in your project directory")};import{existsSync as P,readFileSync as So}from"fs";import{join as S,dirname as $o}from"path";import{execSync as x}from"child_process";import{homedir as me}from"os";var ws=e=>{let o=e.match(/^https:\/\/github\.com\/([^/]+)\/([^/]+)\/tree\/([^/]+)\/(.+)$/);if(o){let[,r,t,n,l]=o;return{type:"git-tree",repoUrl:`https://github.com/${r}/${t}.git`,branch:n,path:l,original:e}}let s=e.match(/^https:\/\/github\.com\/([^/]+)\/([^/]+)(?:\.git)?$/);if(s){let[,r,t]=s;return{type:"git-repo",repoUrl:`https://github.com/${r}/${t}.git`,branch:null,path:null,original:e}}return P(e)?{type:"local",path:e,original:e}:null},Ss=e=>{let o=e.includes("--global")||e.includes("-g"),s=e.includes("--project")||e.includes("-p");if(o)return S(me(),".agents","skills");if(s)return S(process.cwd(),".agents","skills");let r=S(process.cwd(),".agents","config.json"),t=S(me(),".agents","config.json");for(let n of[r,t])if(P(n))try{if(JSON.parse(So(n,"utf8")).installLocation==="project")return S(process.cwd(),".agents","skills")}catch{}return S(me(),".agents","skills")},$s=(e,o)=>{let s=S(me(),".agents","tmp",`skill-install-${Date.now()}`);try{return x(`mkdir -p "${s}"`,{stdio:"pipe"}),o?x(`git clone --branch ${o} --depth 1 "${e}" "${s}"`,{stdio:"pipe",timeout:3e4}):x(`git clone --depth 1 "${e}" "${s}"`,{stdio:"pipe",timeout:3e4}),s}catch(r){try{x(`rm -rf "${s}"`,{stdio:"pipe"})}catch{}throw new Error(`Failed to clone repository: ${r.message}`)}},je=e=>{let o=S(e,"skill.json");if(!P(o))return null;try{let s=So(o,"utf8");return JSON.parse(s)}catch(s){throw new Error(`Failed to read skill.json: ${s.message}`)}},wo=(e,o,s,r)=>{let t=S(e,o);if(!P(t)){r.errors.push(`Skill directory not found: ${o}`);return}let n=je(t);if(!n){r.errors.push(`No skill.json found in: ${o}`);return}let l=n.name||o,a=S(s,l),p=$o(a);try{x(`mkdir -p "${p}"`,{stdio:"pipe"})}catch(c){r.errors.push(`Failed to create directory ${p}: ${c.message}`);return}try{P(a)&&x(`rm -rf "${a}"`,{stdio:"pipe"}),x(`cp -R "${t}" "${a}"`,{stdio:"pipe"}),r.installed.push({name:l,path:a,title:n.title||n.description||l})}catch(c){r.errors.push(`Failed to install ${o}: ${c.message}`)}},Co=()=>{let{getRepositories:e,addRepositoryToConfig:o}=(v(),Ie(Ce)),s=process.argv.slice(3),r=s.find(d=>!d.startsWith("-")),t=s.filter(d=>d.startsWith("-"));if(!r){console.log(`Usage: superpowers-agent add <url-or-path|@alias> [skill-path] [options]

Options:
  --global, -g   Install skills globally in ~/.agents/skills/ (default)
  --project, -p  Install skills in current project's .agents/skills/

Examples:
  superpowers-agent add https://github.com/example/skills
  superpowers-agent add https://github.com/example/repo/tree/main/skills
  superpowers-agent add ~/my-local-skills
  superpowers-agent add https://github.com/example/skills --project
  superpowers-agent add ~/my-local-skills --global
  superpowers-agent add @myrepo path/to/skill
  superpowers-agent add @myrepo path/to/skills --project

Description:
  Installs skill(s) from a Git repository, local directory, or repository alias.
  Supports repositories with single or multiple skills.
  Reads skill.json to determine skill names and installation paths.
  
  Repository aliases can be added using:
    superpowers-agent add-repository <git-url> [--as=@alias]`);return}console.log(`Installing skill(s)...
`);let n=null,l=null;if(r.startsWith("@")){let d=r;l=s.find((h,j)=>j>0&&!h.startsWith("-")&&h!==d);let m=e(!1),u=e(!0);if(m[d])n=m[d],console.log(`Using project repository alias: ${d}`);else if(u[d])n=u[d],console.log(`Using global repository alias: ${d}`);else{console.log(`Error: Repository alias not found: ${d}`),console.log(`
Available aliases:`);let h={...u,...m};if(Object.keys(h).length===0)console.log("  (none)"),console.log(`
Add a repository using:`),console.log("  superpowers-agent add-repository <git-url>");else for(let[j,T]of Object.entries(h))console.log(`  ${j} -> ${T}`);return}let y=P(n);l?y?(r=S(n,l),console.log(`Repository path: ${n}`),console.log(`Skill path: ${l}
`)):(r=`${n}/tree/main/${l}`,console.log(`Repository URL: ${n}`),console.log(`Skill path: ${l}
`)):(r=n,console.log(y?`Repository path: ${n}
`:`Repository URL: ${n}
`))}let a=ws(r);if(!a){console.log(`Error: Invalid URL or path not found: ${r}`);return}let p=Ss(t);console.log(`Install location: ${p}
`);let c,g=!1;try{if(a.type==="git-repo"||a.type==="git-tree"){if(console.log(`Cloning repository: ${a.repoUrl}`),a.branch&&console.log(`Branch: ${a.branch}`),c=$s(a.repoUrl,a.branch),g=!0,a.path&&(c=S(c,a.path),!P(c)))throw new Error(`Path not found in repository: ${a.path}`);console.log("")}else c=a.path;let d=je(c);if(!d)throw new Error("No skill.json found in source directory");let m={installed:[],errors:[],source:a.original};if(d.skills&&Array.isArray(d.skills)){console.log(`Found ${d.skills.length} skill(s) to install
`);for(let u of d.skills)wo(c,u,p,m)}else{let u=d.name||parse(c).base;wo($o(c),parse(c).base,p,m)}if(g&&c)try{let u=c.split("/.agents/tmp/")[0]+"/.agents/tmp/"+c.split("/.agents/tmp/")[1].split("/")[0];x(`rm -rf "${u}"`,{stdio:"pipe"})}catch{}if(console.log(`
**Successfully installed skills:**`),console.log(`- Source: ${m.source}`),m.installed.length>0)for(let u of m.installed)console.log(`  - Installed: ${u.name} at ${u.path}`),console.log(`    ${u.title}`);if(m.errors.length>0){console.log(`
**Errors:**`);for(let u of m.errors)console.log(`  - ${u}`)}m.installed.length===0&&m.errors.length===0&&console.log("  No skills were installed")}catch(d){if(g&&c)try{let m=c.split("/.agents/tmp/")[0]+"/.agents/tmp/"+c.split("/.agents/tmp/")[1].split("/")[0];x(`rm -rf "${m}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${d.message}`)}},xo=()=>{let{readConfigFile:e,writeConfigFile:o,addRepositoryToConfig:s}=(v(),Ie(Ce)),{homedir:r}=Uo("os"),t=process.argv.slice(3),n=t.find(u=>!u.startsWith("-")),l=t.filter(u=>u.startsWith("-"));if(!n){console.log(`Usage: superpowers-agent add-repository <git-url> [options]

Options:
  --global, -g        Add repository globally in ~/.agents/config.json (default)
  --project, -p       Add repository in current project's .agents/config.json
  --as=<alias>        Specify custom alias for the repository

Examples:
  superpowers-agent add-repository https://github.com/example/skills.git
  superpowers-agent add-repository https://github.com/example/skills.git --as=@myskills
  superpowers-agent add-repository https://github.com/example/skills.git --project
  superpowers-agent add-repository https://github.com/example/skills.git --as=@custom --global

Description:
  Adds a skill repository alias to your configuration.
  The repository's skill.json will be read to determine the default alias.
  Use --as to specify a custom alias.
  After adding, you can install skills using: superpowers-agent add @alias path/to/skill`);return}console.log(`Adding repository...
`);let a=l.some(u=>u==="--global"||u==="-g"),p=l.some(u=>u==="--project"||u==="-p"),c=l.find(u=>u.startsWith("--as=")),g=c?c.split("=")[1]:null,d=!p,m;try{console.log(`Cloning repository: ${n}`),m=S(r(),".agents","tmp",`repo-add-${Date.now()}`),x(`mkdir -p "${m}"`,{stdio:"pipe"}),x(`git clone --depth 1 "${n}" "${m}"`,{stdio:"pipe",timeout:3e4}),console.log("");let u=je(m);if(!u)throw new Error("No skill.json found in repository");let y;if(g)y=g;else if(u.repository)y=u.repository;else{let T=n.match(/\/([^/]+?)(?:\.git)?$/);if(T)y="@"+T[1];else throw new Error("Could not determine repository alias. Use --as=@alias to specify manually.")}s(y,n,d),x(`rm -rf "${m}"`,{stdio:"pipe"});let h=d?"globally":"in project",j=d?S(r(),".agents","config.json"):S(process.cwd(),".agents","config.json");console.log(`\u2713 Repository added ${h}`),console.log(`  Alias: ${y}`),console.log(`  URL: ${n}`),console.log(`  Config: ${j}`),console.log(`
You can now install skills using:`),console.log(`  superpowers-agent add ${y} <path-to-skill>`)}catch(u){if(m)try{x(`rm -rf "${m}"`,{stdio:"pipe"})}catch{}console.log(`
Error: ${u.message}`)}};import{dirname as Cs}from"path";var bo=e=>{if(!e){console.log(`Usage: superpowers-agent use-skill <skill-name>

Examples (smart matching):
  superpowers-agent use-skill brainstorming              # Matches superpowers:collaboration/brainstorming
  superpowers-agent use-skill collaboration/brainstorming # More specific suffix
  superpowers-agent use-skill test-driven-development    # Matches superpowers:testing/test-driven-development

Examples (explicit paths):
  superpowers-agent use-skill superpowers:collaboration/brainstorming  # Full superpowers skill path
  superpowers-agent use-skill claude:email-assistant                   # Full claude skill path
  superpowers-agent use-skill my-custom-skill                          # Project skill

Smart matching:
  - Type just the skill name or any suffix of the path
  - Priority: .agents/skills/ > .claude/skills/ > ~/.agents/skills/ > ~/.agents/superpowers/skills/
  - If multiple skills match at same priority, you'll see them with descriptions`);return}let o=E(e);if(!o){console.log(`Error: Skill not found: ${e}

Available skills:`),console.log("Run: superpowers-agent find-skills");return}let{skillFile:s,sourceType:r,actualSkillPath:t}=o;try{let{content:n,frontmatter:l}=Pe(s),a=X[r].prefix+t,p=Cs(s),c=`# ${l.name||a}`;l.description&&(c+=`
# ${l.description}`),l.whenToUse&&(c+=`
# When to use: ${l.whenToUse}`),c+=`
# Supporting tools and docs are in ${p}
# ============================================

${n}`,console.log(c)}catch(n){console.log(n.message)}};var jo={bootstrap:yo,version:uo,"check-updates":()=>{po().catch(e=>{console.error(e.message),process.exit(1)})},update:()=>{let e=process.argv.includes("--no-reinstall");ue({skipReinstall:e})},"config-get":Xe,"config-set":Ze,"setup-skills":ko,"use-skill":()=>bo(process.argv[3]),execute:Ye,"find-skills":N,add:Co,"add-repository":xo,dir:qe,path:ze,"get-helpers":Qe,"install-copilot-prompts":O,"install-copilot-instructions":G,"install-cursor-commands":W,"install-cursor-hooks":_,"install-codex-prompts":J,"install-gemini-commands":V,"install-claude-commands":H,"install-opencode-commands":B,default:()=>{console.log(`Superpowers for Agents
Usage:
  superpowers-agent bootstrap [--no-update]                         # Run complete bootstrap
  superpowers-agent version                                         # Show current version
  superpowers-agent check-updates                                   # Check for updates
  superpowers-agent update [--no-reinstall]                         # Update to latest version
  superpowers-agent config-get                                      # Show configuration
  superpowers-agent config-set <key> <value>                        # Update configuration
  superpowers-agent setup-skills                                    # Initialize project skills
  superpowers-agent use-skill <skill-name>                          # Load a skill
  superpowers-agent find-skills                                     # List available skills
  superpowers-agent add <url-or-path|@alias> [path] [options]      # Install skills
  superpowers-agent add-repository <git-url> [--as=@alias] [opts]  # Add repository alias
  superpowers-agent dir <skill-name>                                # Get skill directory
  superpowers-agent path <skill-name>                               # Get skill file path
  superpowers-agent execute <skill-name>                            # Execute a skill
  superpowers-agent get-helpers <skill> <search-term>               # Get helper file path
  superpowers-agent install-copilot-prompts                         # Install GitHub Copilot prompts
  superpowers-agent install-copilot-instructions                    # Install universal instructions
  superpowers-agent install-cursor-commands                         # Install Cursor commands
  superpowers-agent install-cursor-hooks                            # Install Cursor hooks
  superpowers-agent install-codex-prompts                           # Install Codex prompts
  superpowers-agent install-gemini-commands                         # Install Gemini commands
  superpowers-agent install-claude-commands                         # Install Claude commands
  superpowers-agent install-opencode-commands                       # Install OpenCode commands

Documentation: https://github.com/complexthings/superpowers
`)}},xs=process.argv[2]||"default",bs=jo[xs]||jo.default;try{bs()}catch(e){console.error(`Error: ${e.message}`),process.exit(1)}
